import{d as h,b as _}from"./kz80bbCR.js";import{i as ve}from"./2r1cYJse.js";import{c as ce,o as ue,a as me}from"./D0mpzbhj.js";import{w as be,al as t,am as e,ap as n,Q as a,W as E,z as fe,aj as q,O as y,V as w}from"./BUDlkbfV.js";import{s as b}from"./BbnaKca8.js";import{i as Y}from"./28pso2Hb.js";import{e as _e,i as he}from"./BOGOvxWJ.js";import{r as xe,s as ge}from"./BJyhluUY.js";import{e as N,b as ke}from"./CiCNsvIE.js";import{t as qe,f as ye}from"./B2SxtloT.js";import{a as we,b as Me}from"./njKOc8Q7.js";import{s as Re}from"./BqlTOgs2.js";import{b as Se}from"./BP_wOmgt.js";import{p as A}from"./Bf5_DoVm.js";import{s as De,a as Ie}from"./D32zTIdM.js";import{I as J}from"./DaDtKPX8.js";import{$ as Te}from"./C36u96xB.js";import{a as Ee}from"./E07TNQLR.js";import{t as Ne}from"./sXlFIKQv.js";var Fe=h('<div class="success-message svelte-duq4x3"><!> <h2> </h2> <p> </p></div>'),Le=h('<label class="radio-label svelte-duq4x3"><input type="radio" class="svelte-duq4x3"/> <span> </span></label>'),Oe=h("<span> </span>"),je=h("<span> </span>"),Pe=h('<div class="modal-content svelte-duq4x3"><h2 class="modal-title svelte-duq4x3"><!> </h2> <div class="type-selector svelte-duq4x3"><label class="input-label svelte-duq4x3"> </label> <div class="radio-group svelte-duq4x3"></div></div> <div class="text-input-group svelte-duq4x3"><label class="input-label svelte-duq4x3"> </label> <textarea class="svelte-duq4x3"></textarea></div> <button class="submit-button svelte-duq4x3"><!></button></div>'),ze=h('<div class="modal-backdrop svelte-duq4x3"><div class="modal-container svelte-duq4x3"><button class="close-button svelte-duq4x3" aria-label="닫기"><!></button> <!></div></div>');function oa(B,M){be(M,!1);const[G,H]=De(),l=()=>Ie(Te,"$t",G),U=[];let X=A(M,"personaId",8,""),Z=A(M,"personaName",8,"");const K=ce();let x=E(""),F=E("spam"),v=E(!1),Q=E(!1);const $=[{id:"spam",label:"spam"},{id:"inappropriate",label:"inappropriate"},{id:"copyright",label:"copyright"},{id:"other",label:"other"}];async function ee(o,d){const c={type:o,content:d,targetId:X(),targetName:Z(),timestamp:new Date().toISOString()},u={text:JSON.stringify(c)},f=await Ee.post("/api/feedback",u);if(!f.ok){const m=await f.json().catch(()=>({}));throw new Error(m.error||"Failed to submit report")}}async function ae(){if(!(!a(x).trim()||a(v))){w(v,!0);try{await ee(a(F),a(x)),w(Q,!0),setTimeout(()=>{K("close")},1500)}catch(o){console.error("Report submission error:",o),Ne.error(l()("feedbackModal.submitFailed")||"Failed to submit report"),w(v,!1)}}}function L(){a(v)||K("close")}function V(o){o.key==="Escape"&&L()}ue(()=>{window.addEventListener("keydown",V)}),me(()=>{window.removeEventListener("keydown",V)}),ve();var g=ze(),O=t(g),R=t(O),te=t(R);J(te,{icon:"ph:x-bold"}),e(R);var re=n(R,2);{var oe=o=>{var d=Fe(),c=t(d);J(c,{icon:"ph:check-circle-duotone"});var u=n(c,2),f=t(u,!0);e(u);var m=n(u,2),k=t(m,!0);e(m),e(d),q((j,S)=>{b(f,j),b(k,S)},[()=>l()("reportModal.thanks")||"Thank you",()=>l()("reportModal.thanksMessage")||"Your report has been submitted."],y),_(o,d)},se=o=>{var d=Pe(),c=t(d),u=t(c);J(u,{icon:"ph:warning-circle-bold",style:"vertical-align: middle; margin-right: 8px; color: #ff9800;"});var f=n(u);e(c);var m=n(c,2),k=t(m),j=t(k,!0);e(k);var S=n(k,2);_e(S,5,()=>$,he,(s,r)=>{var p=Le(),i=t(p);xe(i);var T,W=n(i,2),pe=t(W,!0);e(W),e(p),q(C=>{T!==(T=a(r).id)&&(i.value=(i.__value=a(r).id)??""),i.disabled=a(v),b(pe,C)},[()=>l()(`reportModal.types.${a(r).label}`)||a(r).id],y),we(U,[],i,()=>(a(r).id,a(F)),C=>w(F,C)),_(s,p)}),e(S),e(m);var P=n(m,2),z=t(P),ie=t(z,!0);e(z);var D=n(z,2);ke(D),e(P);var I=n(P,2),le=t(I);{var ne=s=>{var r=Oe(),p=t(r,!0);e(r),q(i=>b(p,i),[()=>l()("feedbackModal.sending")||"Sending..."],y),_(s,r)},de=s=>{var r=je(),p=t(r,!0);e(r),q(i=>b(p,i),[()=>l()("reportModal.submit")||"Submit Report"],y),_(s,r)};Y(le,s=>{a(v)?s(ne):s(de,!1)})}e(I),e(d),q((s,r,p,i,T)=>{b(f,` ${s??""}`),b(j,r),b(ie,p),ge(D,"placeholder",i),D.disabled=a(v),I.disabled=T},[()=>l()("reportModal.title")||"Report Content",()=>l()("reportModal.selectType")||"Reason for reporting",()=>l()("reportModal.details")||"Details",()=>l()("reportModal.placeholder")||"Please describe the issue...",()=>a(v)||!a(x).trim()],y),Me(D,()=>a(x),s=>w(x,s)),N("click",I,ae),_(o,d)};Y(re,o=>{a(Q)?o(oe):o(se,!1)})}e(O),e(g),N("click",R,L),N("click",O,Re(function(o){Se.call(this,M,o)})),N("click",g,L),qe(3,g,()=>ye),_(B,g),fe(),H()}export{oa as R};
