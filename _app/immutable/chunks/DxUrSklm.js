import{e as Z,b as o,d as p}from"./kz80bbCR.js";import{i as $}from"./2r1cYJse.js";import{c as ee,a as ae}from"./D0mpzbhj.js";import{w as te,aq as H,ar as se,as as re,z as ie,V as n,W as b,Q as s,ao as L,al as g,an as R,am as w,aj as q,ap as le,O as oe}from"./BUDlkbfV.js";import{e as k}from"./CiCNsvIE.js";import{i as m}from"./28pso2Hb.js";import{s as A,a as ve}from"./BJyhluUY.js";import{b as ne}from"./CGc6l0L7.js";import{p as pe}from"./Bf5_DoVm.js";import{f as O}from"./Caezn3U5.js";import{I as U}from"./DaDtKPX8.js";var ce=p('<div class="fallback secret svelte-1npbvbn"><!> <p>Private Asset</p></div>'),de=p('<img alt="asset" class="asset-preview-media svelte-1npbvbn"/>'),fe=p('<img alt="preview" class="asset-preview-media video-poster-layer svelte-1npbvbn"/>'),ue=p('<div class="video-container svelte-1npbvbn"><!> <video autoplay loop playsinline="">Your browser does not support the video tag.</video></div>',2),_e=p('<div class="fallback svelte-1npbvbn"><!> <p>Unknown file type</p></div>'),me=p('<img alt="asset preview" class="asset-preview-media svelte-1npbvbn"/>'),he=p('<div class="loading svelte-1npbvbn"><!> <p>Loading...</p></div>'),ye=p('<div class="fallback svelte-1npbvbn"><!></div>');function Se(Q,W){te(W,!1);let e=pe(W,"asset",12);const T=ee();let I=b(!1),h=b(!1);const j="asset_type_cache:";ae(()=>{n(h,!0)});const V=t=>localStorage.getItem(j+t),X=(t,i)=>{localStorage.setItem(j+t,i)};let C=b(null),E=b(!1),x=b("");H(()=>(L(e()),s(I),s(x),s(h),O),()=>{const t=e()&&!e().type&&!(e().is_secret&&!e().url)&&!s(I);if(e()?.url&&e().url!==s(x)&&(n(x,e().url),n(E,!1)),t&&e().url){const i=V(e().url);i?e({...e(),type:i}):(n(I,!0),n(h,!1),(async()=>{try{const v=await O([e()]);if(s(h))return;if(v[0]?.type){const F=v[0].type;e().url&&X(e().url,F),e({...e(),type:F})}else e({...e(),type:"unknown"})}catch(v){console.error("Failed to fetch asset type:",v),s(h)||e({...e(),type:"unknown"})}finally{n(I,!1)}})())}}),H(()=>(L(e()),s(C)),()=>{e().type==="video"&&s(C)&&e().url}),se(),$();var z=Z(),Y=re(z);{var B=t=>{var i=ce(),v=g(i);U(v,{icon:"ph:lock-key-duotone",width:"48",height:"48"}),R(2),w(i),o(t,i)},G=(t,i)=>{{var v=c=>{var d=de();q(()=>A(d,"src",e().url)),k("load",d,()=>T("load",{url:e().url})),k("error",d,()=>T("error",{url:e().url})),o(c,d)},F=(c,d)=>{{var J=f=>{var y=ue(),P=g(y);{var D=r=>{var S=fe();q(()=>A(S,"src",e().static_url||"/placeholder-portrait.png")),o(r,S)};m(P,r=>{s(E)||r(D)})}var a=le(P,2);a.muted=!0;let l;ne(a,r=>n(C,r),()=>s(C)),w(y),q(r=>{A(a,"src",e().url),A(a,"poster",e().static_url||void 0),l=ve(a,1,"asset-preview-media gif-like-video svelte-1npbvbn",null,l,r)},[()=>({"video-visible":s(E)})],oe),k("playing",a,()=>{n(E,!0)}),k("loadeddata",a,()=>T("load",{url:e().url})),k("error",a,()=>T("error",{url:e().url})),o(f,y)},K=(f,y)=>{{var P=a=>{var l=_e(),r=g(l);U(r,{icon:"ph:file-duotone",width:"48",height:"48"}),R(2),w(l),o(a,l)},D=a=>{var l=ye(),r=g(l);{var S=u=>{var _=me();q(()=>A(_,"src",e().static_url)),o(u,_)},M=u=>{var _=he(),N=g(_);U(N,{icon:"ph:spinner-duotone",width:"32",height:"32",class:"spin"}),R(2),w(_),o(u,_)};m(r,u=>{e().static_url?u(S):u(M,!1)})}w(l),o(a,l)};m(f,a=>{e().type==="unknown"?a(P):a(D,!1)},y)}};m(c,f=>{e().type==="video"?f(J):f(K,!1)},d)}};m(t,c=>{e().type==="image"?c(v):c(F,!1)},i)}};m(Y,t=>{e().is_secret&&!e().url?t(B):t(G,!1)})}o(Q,z),ie()}export{Se as A};
