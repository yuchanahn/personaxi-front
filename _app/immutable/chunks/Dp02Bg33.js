import{e as wr,b,d as x,t as br}from"./kz80bbCR.js";import{i as ta}from"./2r1cYJse.js";import{c as Pa,o as Ba,a as xr}from"./D0mpzbhj.js";import{w as aa,as as Er,z as ra,ap as s,al as a,am as t,aj as R,O as re,aq as Ha,ar as Va,Q as e,W as k,V as o,ao as Rr,an as yr,au as ze,aD as $a}from"./BUDlkbfV.js";import{s as n}from"./BbnaKca8.js";import{i as H}from"./28pso2Hb.js";import{e as ge,b as fe}from"./CiCNsvIE.js";import{a as Pr}from"./BqlTOgs2.js";import{p as we}from"./Bf5_DoVm.js";import{s as sa,a as ia}from"./D32zTIdM.js";import{N as Lr}from"./kAk1PkLC.js";import{$ as la}from"./C36u96xB.js";import{e as Oe,i as Ke}from"./BOGOvxWJ.js";import{a as he,s as Y,r as Zt,b as Ia,f as ea,e as kr}from"./BJyhluUY.js";import{b as pe,c as Sr}from"./njKOc8Q7.js";import{b as Dr}from"./CGc6l0L7.js";import{I as Ma}from"./DaDtKPX8.js";import{A as Na}from"./DxUrSklm.js";import{t as mt}from"./sXlFIKQv.js";import{c as Ca}from"./DMOjeqFW.js";import{G as jr}from"./D5415qcM.js";import{aj as Ar}from"./vNtm5tQc.js";import{g as Jt,u as Qt,b as Tr}from"./Caezn3U5.js";var Ur=x('<div class="modal-backdrop svelte-1qwexaa"><div class="confetti svelte-1qwexaa"></div> <div class="confetti svelte-1qwexaa"></div> <div class="confetti svelte-1qwexaa"></div> <div class="modal-content svelte-1qwexaa"><button class="close-button svelte-1qwexaa">&times;</button> <div class="icon-container svelte-1qwexaa"><!></div> <h2 class="svelte-1qwexaa"> </h2> <p class="reward-text svelte-1qwexaa"> <br/> <span class="highlight svelte-1qwexaa"> </span> </p> <p class="description svelte-1qwexaa"> </p> <button class="confirm-button svelte-1qwexaa"> </button></div></div>');function Qs(g,i){aa(i,!1);const[c,u]=sa(),r=()=>ia(la,"$t",c);let l=we(i,"isOpen",12,!1);const y=Pa();function L(){l(!1),y("close")}function I(A){l()&&A.key==="Escape"&&L()}Ba(()=>{window.addEventListener("keydown",I)}),xr(()=>{window.removeEventListener("keydown",I)}),ta();var C=wr(),U=Er(C);{var O=A=>{var M=Ur(),N=s(a(M),6),F=a(N),V=s(F,2),J=a(V);Lr(J,{size:64,color:"#ffc107"}),t(V);var q=s(V,2),G=a(q,!0);t(q);var W=s(q,2),te=a(W,!0),X=s(te,3),K=a(X);t(X);var B=s(X,1,!0);t(W);var Z=s(W,2),oe=a(Z,!0);t(Z);var be=s(Z,2),Ue=a(be,!0);t(be),t(N),t(M),R(($e,at,Ie,rt,Pe,De)=>{n(G,$e),n(te,at),n(K,`100 ${Ie??""}`),n(B,rt),n(oe,Pe),n(Ue,De)},[()=>r()("firstCreationRewardModal.title"),()=>r()("firstCreationRewardModal.message1"),()=>r()("paymentModal.creditsUnit"),()=>r()("firstCreationRewardModal.message2",{values:{amount:100}}),()=>r()("firstCreationRewardModal.message3"),()=>r()("firstCreationRewardModal.confirm")],re),ge("click",F,L),ge("click",be,L),ge("click",M,Pr(L)),b(A,M)};H(U,A=>{l()&&A(O)})}b(g,C),ra(),u()}async function Or(g){return new Promise((i,c)=>{const u=URL.createObjectURL(g),r=new jr;r.register(l=>new Ar(l)),r.load(u,l=>{if(URL.revokeObjectURL(u),!(l.userData.vrm?.meta||l.userData.vrmMeta)){console.warn("No VRM meta found"),i(!1);return}i(!0)},l=>{},l=>{URL.revokeObjectURL(u),console.error("Failed to load VRM for validation:",l),i(!1)})})}async function $r(g){return new Promise(i=>{const c=document.createElement("video");c.preload="metadata",c.muted=!0,c.playsInline=!0;const u=URL.createObjectURL(g);c.src=u,c.onloadedmetadata=()=>{let r=.5;c.duration<1&&(r=c.duration/2),c.currentTime=r},c.onseeked=()=>{const r=document.createElement("canvas");r.width=c.videoWidth,r.height=c.videoHeight;const l=r.getContext("2d");if(!l){URL.revokeObjectURL(u),i(null);return}l.drawImage(c,0,0,r.width,r.height),r.toBlob(y=>{if(URL.revokeObjectURL(u),y){const L=new File([y],"thumbnail.jpg",{type:"image/jpeg",lastModified:Date.now()});i(L)}else i(null)},"image/jpeg",.9)},c.onerror=()=>{console.error("Video load error in extractFirstFrame"),URL.revokeObjectURL(u),i(null)},setTimeout(()=>{},5e3)})}async function Ir(g,i){return new Promise(c=>{const u=document.createElement("video");u.preload="metadata";const r=URL.createObjectURL(g);u.src=r,u.onloadedmetadata=()=>{URL.revokeObjectURL(r);const l=u.duration;c({valid:l<=i,duration:l})},u.onerror=()=>{URL.revokeObjectURL(r),c({valid:!1,duration:0})}})}var D;(function(g){g.LOAD="LOAD",g.EXEC="EXEC",g.FFPROBE="FFPROBE",g.WRITE_FILE="WRITE_FILE",g.READ_FILE="READ_FILE",g.DELETE_FILE="DELETE_FILE",g.RENAME="RENAME",g.CREATE_DIR="CREATE_DIR",g.LIST_DIR="LIST_DIR",g.DELETE_DIR="DELETE_DIR",g.ERROR="ERROR",g.DOWNLOAD="DOWNLOAD",g.PROGRESS="PROGRESS",g.LOG="LOG",g.MOUNT="MOUNT",g.UNMOUNT="UNMOUNT"})(D||(D={}));const Mr=(()=>{let g=0;return()=>g++})(),Nr=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),Cr=new Error("called FFmpeg.terminate()");class Fr{#t=null;#r={};#a={};#s=[];#i=[];loaded=!1;#l=()=>{this.#t&&(this.#t.onmessage=({data:{id:i,type:c,data:u}})=>{switch(c){case D.LOAD:this.loaded=!0,this.#r[i](u);break;case D.MOUNT:case D.UNMOUNT:case D.EXEC:case D.FFPROBE:case D.WRITE_FILE:case D.READ_FILE:case D.DELETE_FILE:case D.RENAME:case D.CREATE_DIR:case D.LIST_DIR:case D.DELETE_DIR:this.#r[i](u);break;case D.LOG:this.#s.forEach(r=>r(u));break;case D.PROGRESS:this.#i.forEach(r=>r(u));break;case D.ERROR:this.#a[i](u);break}delete this.#r[i],delete this.#a[i]})};#e=({type:i,data:c},u=[],r)=>this.#t?new Promise((l,y)=>{const L=Mr();this.#t&&this.#t.postMessage({id:L,type:i,data:c},u),this.#r[L]=l,this.#a[L]=y,r?.addEventListener("abort",()=>{y(new DOMException(`Message # ${L} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(Nr);on(i,c){i==="log"?this.#s.push(c):i==="progress"&&this.#i.push(c)}off(i,c){i==="log"?this.#s=this.#s.filter(u=>u!==c):i==="progress"&&(this.#i=this.#i.filter(u=>u!==c))}load=({classWorkerURL:i,...c}={},{signal:u}={})=>(this.#t||(this.#t=i?new Worker(new URL(i,import.meta.url),{type:"module"}):new Worker(new URL(""+new URL("../workers/worker-BAOIWoxA.js",import.meta.url).href,import.meta.url),{type:"module"}),this.#l()),this.#e({type:D.LOAD,data:c},void 0,u));exec=(i,c=-1,{signal:u}={})=>this.#e({type:D.EXEC,data:{args:i,timeout:c}},void 0,u);ffprobe=(i,c=-1,{signal:u}={})=>this.#e({type:D.FFPROBE,data:{args:i,timeout:c}},void 0,u);terminate=()=>{const i=Object.keys(this.#a);for(const c of i)this.#a[c](Cr),delete this.#a[c],delete this.#r[c];this.#t&&(this.#t.terminate(),this.#t=null,this.loaded=!1)};writeFile=(i,c,{signal:u}={})=>{const r=[];return c instanceof Uint8Array&&r.push(c.buffer),this.#e({type:D.WRITE_FILE,data:{path:i,data:c}},r,u)};mount=(i,c,u)=>{const r=[];return this.#e({type:D.MOUNT,data:{fsType:i,options:c,mountPoint:u}},r)};unmount=i=>{const c=[];return this.#e({type:D.UNMOUNT,data:{mountPoint:i}},c)};readFile=(i,c="binary",{signal:u}={})=>this.#e({type:D.READ_FILE,data:{path:i,encoding:c}},void 0,u);deleteFile=(i,{signal:c}={})=>this.#e({type:D.DELETE_FILE,data:{path:i}},void 0,c);rename=(i,c,{signal:u}={})=>this.#e({type:D.RENAME,data:{oldPath:i,newPath:c}},void 0,u);createDir=(i,{signal:c}={})=>this.#e({type:D.CREATE_DIR,data:{path:i}},void 0,c);listDir=(i,{signal:c}={})=>this.#e({type:D.LIST_DIR,data:{path:i}},void 0,c);deleteDir=(i,{signal:c}={})=>this.#e({type:D.DELETE_DIR,data:{path:i}},void 0,c)}var Fa;(function(g){g.MEMFS="MEMFS",g.NODEFS="NODEFS",g.NODERAWFS="NODERAWFS",g.IDBFS="IDBFS",g.WORKERFS="WORKERFS",g.PROXYFS="PROXYFS"})(Fa||(Fa={}));const Wr=new Error("failed to get response body reader"),Br=new Error("failed to complete download"),Hr="Content-Length",Vr=g=>new Promise((i,c)=>{const u=new FileReader;u.onload=()=>{const{result:r}=u;r instanceof ArrayBuffer?i(new Uint8Array(r)):i(new Uint8Array)},u.onerror=r=>{c(Error(`File could not be read! Code=${r?.target?.error?.code||-1}`))},u.readAsArrayBuffer(g)}),qr=async g=>{let i;if(typeof g=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(g)?i=atob(g.split(",")[1]).split("").map(c=>c.charCodeAt(0)):i=await(await fetch(g)).arrayBuffer();else if(g instanceof URL)i=await(await fetch(g)).arrayBuffer();else if(g instanceof File||g instanceof Blob)i=await Vr(g);else return new Uint8Array;return new Uint8Array(i)},Gr=async(g,i)=>{const c=await fetch(g);let u;try{const r=parseInt(c.headers.get(Hr)||"-1"),l=c.body?.getReader();if(!l)throw Wr;const y=[];let L=0;for(;;){const{done:U,value:O}=await l.read(),A=O?O.length:0;if(U){if(r!=-1&&r!==L)throw Br;i&&i({url:g,total:r,received:L,delta:A,done:U});break}y.push(O),L+=A,i&&i({url:g,total:r,received:L,delta:A,done:U})}const I=new Uint8Array(L);let C=0;for(const U of y)I.set(U,C),C+=U.length;u=I.buffer}catch(r){console.log("failed to send download progress event: ",r),u=await c.arrayBuffer()}return u},Wa=async(g,i,c=!1,u)=>{const r=c?await Gr(g,u):await(await fetch(g)).arrayBuffer(),l=new Blob([r],{type:i});return URL.createObjectURL(l)};class Lt{static instance;ffmpeg;loaded=!1;loadingPromise=null;loadError=null;constructor(){this.ffmpeg=new Fr}static getInstance(){return Lt.instance||(Lt.instance=new Lt),Lt.instance}async load(){if(!this.loaded)return this.loadingPromise?this.loadingPromise:(this.loadingPromise=(async()=>{try{const i="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";await this.ffmpeg.load({coreURL:await Wa(`${i}/ffmpeg-core.js`,"text/javascript"),wasmURL:await Wa(`${i}/ffmpeg-core.wasm`,"application/wasm")}),this.loaded=!0,console.log("FFmpeg loaded successfully")}catch(i){throw console.error("FFmpeg load failed:",i),this.loadError=i.message,this.loadingPromise=null,i}})(),this.loadingPromise)}async compressVideo(i,c){this.loaded||await this.load();const{ffmpeg:u}=this,r="input.mp4",l="output.mp4";try{await u.writeFile(r,await qr(i)),c&&u.on("progress",({progress:L})=>{c(Math.round(L*100))}),await u.exec(["-i",r,"-c:v","libx264","-crf","28","-preset","fast","-c:a","aac","-b:a","128k",l]);const y=await u.readFile(l);return await u.deleteFile(r),await u.deleteFile(l),new File([y],i.name,{type:"video/mp4"})}catch(y){throw console.error("Video compression failed:",y),y}}}var Xr=x('<span class="file-name svelte-jv8oow"> </span>'),Kr=x('<div class="upload-status svelte-jv8oow"><!> <span> </span></div>'),zr=x('<div class="upload-status svelte-jv8oow"><span> </span></div>'),Yr=x("<div><!></div>"),Jr=x('<span class="file-name svelte-jv8oow"> </span>'),Qr=x('<div class="progress-bar-container" style="margin-top: 10px; height: 5px; background: #eee; border-radius: 3px; overflow: hidden;"><div class="progress-bar svelte-jv8oow"></div></div>'),Zr=x('<div class="success-message" style="margin-top: 10px; color: green;">âœ… Live2D Model Uploaded!</div>'),es=x(`<div class="form-group asset-section svelte-jv8oow"><h3 class="asset-title svelte-jv8oow">Live2D Model Upload</h3> <p class="description svelte-jv8oow">Upload your Live2D model ZIP file (must contain
                    model3.json).</p> <div class="file-input-container svelte-jv8oow"><button type="button" class="file-input-label svelte-jv8oow"><span> </span></button> <input id="live2d-file" type="file" accept=".zip" class="file-input-hidden svelte-jv8oow"/> <!></div> <!> <!></div>`),ts=x('<div class="progress-bar-overlay svelte-jv8oow"><div class="progress-bar svelte-jv8oow"></div></div>'),as=x("<span> </span>"),rs=x("<span> </span>"),ss=x('<div class="asset-card svelte-jv8oow"><div class="asset-image-uploader svelte-jv8oow"><!> <!> <label class="file-input-label small svelte-jv8oow"><span> </span></label> <input type="file" accept="image/*, video/*" class="file-input-hidden svelte-jv8oow"/></div> <div class="asset-details svelte-jv8oow"><textarea class="asset-description-input svelte-jv8oow" rows="3"></textarea> <div class="asset-card-actions svelte-jv8oow"><div class="secret-toggle-group svelte-jv8oow"><label class="toggle-switch small svelte-jv8oow"><input type="checkbox" class="svelte-jv8oow"/> <span class="slider svelte-jv8oow"></span></label> <span class="secret-label svelte-jv8oow"> </span> <div class="tooltip-icon small svelte-jv8oow"><!> <div class="tooltip-text svelte-jv8oow"> </div></div></div> <button type="button" class="btn btn-secondary btn-copy svelte-jv8oow"><!></button> <button class="btn-remove asset-remove svelte-jv8oow">&times;</button></div></div></div>'),is=x('<div class="form-group asset-section svelte-jv8oow"><h3 class="asset-title svelte-jv8oow"> </h3> <p class="description svelte-jv8oow"> </p> <div class="asset-card-list svelte-jv8oow"></div> <div class="asset-actions svelte-jv8oow"><label for="multiple-asset-upload" class="btn btn-secondary svelte-jv8oow"> </label> <input id="multiple-asset-upload" type="file" multiple accept="image/*, video/*" class="file-input-hidden svelte-jv8oow"/></div></div>'),ls=x('<span class="file-name svelte-jv8oow"> </span>'),os=x('<div class="form-group svelte-jv8oow"><label for="vrm" class="svelte-jv8oow"> </label> <div class="file-input-container svelte-jv8oow"><button type="button" class="btn btn-secondary file-input-label svelte-jv8oow"><span> </span></button> <input id="vrm-file" type="file" accept=".vrm" class="file-input-hidden svelte-jv8oow"/> <!> <!></div></div>'),ns=x("<option> </option>"),vs=x('<div class="voice-selector svelte-jv8oow"><select id="voice-select" class="svelte-jv8oow"><option disabled> </option><!></select></div>'),cs=x("<p> </p>"),ds=x('<div class="form-group svelte-jv8oow"><label for="voice-select" class="svelte-jv8oow"> </label> <p class="description svelte-jv8oow"> </p> <!></div>'),us=x('<div class="form-section-card svelte-jv8oow"><h2 class="svelte-jv8oow"> </h2> <div class="form-group svelte-jv8oow"><label for="portrait" class="svelte-jv8oow"> </label> <div class="file-input-container svelte-jv8oow"><label for="portrait-file" class="file-input-label svelte-jv8oow"><span> </span></label> <input id="portrait-file" type="file" accept="image/*, video/*" class="file-input-hidden svelte-jv8oow"/> <!> <!></div> <!> <!> <!></div> <!> <!></div>');function Zs(g,i){aa(i,!1);const[c,u]=sa(),r=()=>ia(la,"$t",c);let l=we(i,"persona",12),y=we(i,"originalPersona",8),L=we(i,"allVoices",24,()=>[]),I=we(i,"selectedVoiceId",12);const C="https://uohepkqmwbstbmnkoqju.supabase.co/storage/v1/object/public/personaxi-assets/";let U=k(null),O=k(null),A=k(null),M=null,N=k(null),F=k(void 0),V=k(),J=k(0),q=k(0),G=k(0),W=k(0),te=k(!1),X=k(new Map),K=k(new Map);async function B(p){const v=p.target;if(v.files&&v.files.length>0){if(o(U,v.files[0]),!await Or(e(U))){mt.error(r()("editPage.vrmLicenseError")),v.value="",o(U,null);return}oe()}}async function Z(p){const v=p.target;if(v.files&&v.files.length>0){const _=v.files[0];if(o(A,_),_.type.startsWith("video/")){const{valid:f,duration:h}=await Ir(_,6);if(!f){h>6?mt.error(`Video is too long (${h.toFixed(1)}s). Max 6 seconds allowed.`):mt.error("Failed to load video metadata."),v.value="";return}const P=await $r(_);P?(M=P,o(N,URL.createObjectURL(P)),o(F,"image")):(o(N,URL.createObjectURL(_)),o(F,"video"));try{o(te,!0),o(W,0),mt.info("Compressing video... Please wait.");const T=await Lt.getInstance().compressVideo(_,ne=>{o(W,ne)});o(A,T),mt.success("Compression complete!")}catch(T){console.error("Compression failed, using original:",T),mt.error("Compression failed. Uploading original.")}finally{o(te,!1),o(W,0)}}else M=null,o(N,URL.createObjectURL(_)),o(F,"image");be()}}async function oe(){for(let v=1;v<=3;v++)try{const _=l().vrm_url!==y()?.vrm_url,f=l().vrm_url&&!l().vrm_url.startsWith("blob:")&&_?l().vrm_url:void 0,h=await Jt("vrm",f);if(!h.ok)throw new Error(`Server error on getting URL: ${h.status}`);const{signedURL:P,fileName:T}=await h.json();o(q,.01),await Qt(P,e(U),ne=>{o(q,Math.round(ne))}),l(l().vrm_url=`${C}${T}`,!0),o(q,0);return}catch(_){console.warn(`Attempt ${v} for ${e(U).name} failed: ${_.message}`),v===3?(`${e(U).name}`,console.error("Giving up on upload for",e(U).name)):await new Promise(f=>setTimeout(f,500))}}async function be(){for(let v=1;v<=3;v++)try{const _=l().portrait_url!==y()?.portrait_url,f=l().portrait_url&&!l().portrait_url.startsWith("blob:")&&_?l().portrait_url:void 0,h=await Jt("portrait",f);if(!h.ok)throw new Error(`Server error on getting URL: ${h.status}`);const{signedURL:P,fileName:T}=await h.json();o(G,.01),await Qt(P,e(A),ne=>{o(G,Math.round(ne))}),l(l().portrait_url=`${C}${T}`,!0),o(G,0),M?await Ue(M):l(l().static_portrait_url=l().portrait_url,!0);return}catch(_){console.warn(`Attempt ${v} for ${e(A).name} failed: ${_.message}`),v===3?(`${e(A).name}`,console.error("Giving up on upload for",e(A).name)):await new Promise(f=>setTimeout(f,500))}}async function Ue(p){try{const v=await Jt("asset",void 0);if(!v.ok)return;const{signedURL:_,fileName:f}=await v.json();await Qt(_,p,h=>{}),l(l().static_portrait_url=`${C}${f}`,!0)}catch(v){console.error("Failed to upload static portrait",v)}}async function $e(p){const v=p.target;if(!v.files||v.files.length===0)return;const _=v.files[0];o(O,_),o(J,0);try{const f=l().live2d_model_url!==y()?.live2d_model_url?l().live2d_model_url:void 0,h=await Tr(_,P=>{o(J,Math.round(P))},f);l(l().live2d_model_url=h.model3_json_url,!0),at("metadataLoaded",{expressions:h.expressions,motions:h.motions})}catch(f){console.error("Live2D Upload Error:",f),`${f.message}`,o(O,null)}}const at=Pa();async function Ie(){await Ca.ask(r()("editPage.vrmLicenseWarning"))&&e(V).click()}async function rt(){await Ca.ask(r()("editPage.licenseUploadWarning"))&&document.getElementById("live2d-file")?.click()}async function Pe(p){const v=p.target;if(v.files){if(l().image_metadatas.length+v.files.length>40){mt.warning("Maximum 40 images allowed.");return}Array.from(v.files).forEach(async _=>{const f={url:"",description:_.name};l().image_metadatas==null&&l(l().image_metadatas=[],!0),l().image_metadatas.push(f),l(l()),await Me(l().image_metadatas.length-1,_)})}}async function De(p,v){const _=p.target;if(_.files&&_.files.length>0){const f=_.files[0];await Me(v,f)}}async function Me(p,v){for(let f=1;f<=3;f++)try{const h=l().image_metadatas[p]?.url,P=y()?.image_metadatas?.[p]?.url,T=h!==P,ne=h&&!h.startsWith("blob:")&&T?h:void 0,ve=await Jt("asset",ne);if(!ve.ok)throw new Error(`Server error on getting URL: ${ve.status}`);const{signedURL:ae,fileName:Q}=await ve.json();f===1&&(l(l().image_metadatas[p].url=URL.createObjectURL(v),!0),l(l().image_metadatas[p].type=v.type.startsWith("video/")?"video":"image",!0),l(l().image_metadatas=[...l().image_metadatas],!0)),await Qt(ae,v,se=>{e(X).set(p,se),o(X,e(X))}),e(X).delete(p),o(X,e(X)),l(l().image_metadatas[p].url=`${C}${Q}`,!0),l(l().image_metadatas[p].type=v.type.startsWith("video/")?"video":"image",!0);return}catch(h){console.warn(`Attempt ${f} for ${v.name} failed: ${h.message}`),f===3||await new Promise(P=>setTimeout(P,500))}}async function kt(p){const v=`<img ${p}>`;try{await navigator.clipboard.writeText(v),e(K).set(p,!0),o(K,e(K)),setTimeout(()=>{e(K).set(p,!1),o(K,e(K))},2e3)}catch(_){console.error("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:",_)}}function st(p){l(l().image_metadatas=l().image_metadatas.filter((v,_)=>_!==p),!0)}Ha(()=>(Rr(l()),e(N)),()=>{l().portrait_url&&!e(N)&&o(N,l().portrait_url)}),Va(),ta();var je=us(),it=a(je),Ne=a(it,!0);t(it);var Ce=s(it,2),Le=a(Ce),lt=a(Le,!0);t(Le);var Fe=s(Le,2),ot=a(Fe),We=a(ot),nt=a(We,!0);t(We),t(ot);var vt=s(ot,2),ft=s(vt,2);{var ht=p=>{var v=Xr(),_=a(v,!0);t(v),R(()=>n(_,e(A).name)),b(p,v)};H(ft,p=>{e(A)&&p(ht)})}var St=s(ft,2);{var wt=p=>{var v=Kr(),_=a(v);Ma(_,{icon:"line-md:loading-twotone-loop",width:"24",height:"24"});var f=s(_,2),h=a(f);t(f),t(v),R(()=>n(h,`Compressing Video... ${e(W)??""}%`)),b(p,v)},Dt=(p,v)=>{{var _=f=>{var h=zr(),P=a(h),T=a(P);t(P),t(h),R(()=>n(T,`Uploading... ${e(G)??""}%`)),b(f,h)};H(p,f=>{e(G)>0&&f(_)},v)}};H(St,p=>{e(te)?p(wt):p(Dt,!1)})}t(Fe);var ct=s(Fe,2);{var jt=p=>{var v=Yr();let _;var f=a(v);const h=re(()=>({url:e(N),description:"",type:e(F)}));Na(f,{get asset(){return e(h)}}),t(v),R(P=>_=he(v,1,"portrait-preview clickable svelte-jv8oow",null,_,P),[()=>({"has-id":!!l().id})],re),b(p,v)};H(ct,p=>{e(N)&&p(jt)})}var dt=s(ct,2);{var At=p=>{var v=es(),_=s(a(v),4),f=a(_),h=a(f),P=a(h,!0);t(h),t(f);var T=s(f,2),ne=s(T,2);{var ve=w=>{var j=Jr(),ie=a(j,!0);t(j),R(()=>n(ie,e(O).name)),b(w,j)};H(ne,w=>{e(O)&&w(ve)})}t(_);var ae=s(_,2);{var Q=w=>{var j=Qr(),ie=a(j);t(j),R(()=>Ia(ie,`width: ${e(J)??""}%; height: 100%; background: var(--primary);`)),b(w,j)};H(ae,w=>{e(J)>0&&e(J)<100&&w(Q)})}var se=s(ae,2);{var z=w=>{var j=Zr();b(w,j)};H(se,w=>{l().live2d_model_url&&w(z)})}t(v),R(w=>n(P,w),[()=>r()("editPage.fileSelect")],re),ge("click",f,rt),ge("change",T,$e),b(p,v)};H(dt,p=>{l().personaType=="2.5D"&&l().contentType!=="story"&&p(At)})}var ut=s(dt,2);{var pt=p=>{var v=is(),_=a(v),f=a(_);t(_);var h=s(_,2),P=a(h,!0);t(h);var T=s(h,2);Oe(T,5,()=>l().image_metadatas,Ke,(se,z,w)=>{var j=ss(),ie=a(j),Ae=a(ie);{var Be=$=>{Na($,{get asset(){return e(z)}})};H(Ae,$=>{e(z).url!==""&&$(Be)})}var Je=s(Ae,2);{var Ut=$=>{var _e=ts(),Ve=a(_e);t(_e),R(Te=>Ia(Ve,`width: ${Te??""}%`),[()=>e(X).get(w)],re),b($,_e)};H(Je,$=>{e(X).has(w)&&$(Ut)})}var He=s(Je,2);Y(He,"for",`asset-file-${w}`);var bt=a(He),Bt=a(bt,!0);t(bt),t(He);var Ht=s(He,2);Y(Ht,"id",`asset-file-${w}`),t(ie);var xt=s(ie,2),Qe=a(xt);fe(Qe);var Et=s(Qe,2),Ot=a(Et),Rt=a(Ot),Vt=a(Rt);Zt(Vt),yr(2),t(Rt);var Ze=s(Rt,2),$t=a(Ze,!0);t(Ze);var It=s(Ze,2),qt=a(It);Ma(qt,{icon:"ph:question-bold"});var yt=s(qt,2),Mt=a(yt,!0);t(yt),t(It),t(Ot);var et=s(Ot,2),na=a(et);{var Gt=$=>{var _e=as(),Ve=a(_e,!0);t(_e),R(Te=>n(Ve,Te),[()=>r()("editPage.assets.copySuccess")],re),b($,_e)},va=$=>{var _e=rs(),Ve=a(_e,!0);t(_e),R(Te=>n(Ve,Te),[()=>r()("editPage.assets.copy")],re),b($,_e)};H(na,$=>{e(K).get(w)?$(Gt):$(va,!1)})}t(et);var Pt=s(et,2);t(Et),t(xt),t(j),R(($,_e,Ve,Te)=>{n(Bt,$),Y(Qe,"placeholder",_e),n($t,Ve),n(Mt,Te)},[()=>r()("editPage.imageSelect"),()=>r()("editPage.assetDescriptionPlaceholder"),()=>r()("editPage.assets.secretLabel"),()=>r()("editPage.assets.secretTooltip")],re),ge("change",Ht,$=>De($,w)),pe(Qe,()=>e(z).description,$=>(e(z).description=$,ze(()=>l()))),Sr(Vt,()=>e(z).is_secret,$=>(e(z).is_secret=$,ze(()=>l()))),ge("click",et,()=>kt(w)),ge("click",Pt,()=>st(w)),b(se,j)}),t(T);var ne=s(T,2),ve=a(ne),ae=a(ve,!0);t(ve);var Q=s(ve,2);t(ne),t(v),R((se,z,w)=>{n(f,`${se??""} (${l().image_metadatas.length??""} / 40)`),n(P,z),n(ae,w)},[()=>r()("editPage.assetSectionTitle"),()=>r()("editPage.assetSectionDescription"),()=>r()("editPage.addAssetButton")],re),ge("change",Q,Pe),b(p,v)};H(ut,p=>{l().personaType=="2D"&&p(pt)})}t(Ce);var Ye=s(Ce,2);{var Tt=p=>{var v=os(),_=a(v),f=a(_,!0);t(_);var h=s(_,2),P=a(h),T=a(P),ne=a(T,!0);t(T),t(P);var ve=s(P,2);Dr(ve,w=>o(V,w),()=>e(V));var ae=s(ve,2);{var Q=w=>{var j=ls(),ie=a(j,!0);t(j),R(()=>n(ie,e(U).name)),b(w,j)};H(ae,w=>{e(U)&&w(Q)})}var se=s(ae,2);{var z=w=>{var j=br();R(()=>n(j,`${e(q)??""}%`)),b(w,j)};H(se,w=>{e(q)>0&&w(z)})}t(h),t(v),R((w,j)=>{n(f,w),n(ne,j)},[()=>r()("editPage.vrmFileLabel"),()=>r()("editPage.fileSelect")],re),ge("click",P,Ie),ge("change",ve,B),b(p,v)};H(Ye,p=>{l().personaType=="3D"&&l().contentType!=="story"&&p(Tt)})}var Wt=s(Ye,2);{var oa=p=>{var v=ds(),_=a(v),f=a(_,!0);t(_);var h=s(_,2),P=a(h,!0);t(h);var T=s(h,2);{var ne=ae=>{var Q=vs(),se=a(Q);R(()=>{I(),ze(()=>{r(),L()})});var z=a(se);z.value=z.__value="";var w=a(z,!0);t(z);var j=s(z);Oe(j,1,L,ie=>ie._id,(ie,Ae)=>{var Be=ns(),Je={},Ut=a(Be);t(Be),R(()=>{Je!==(Je=e(Ae)._id)&&(Be.value=(Be.__value=e(Ae)._id)??""),n(Ut,`${e(Ae).title??""} - ${e(Ae).description??""}`)}),b(ie,Be)}),t(se),t(Q),R(ie=>n(w,ie),[()=>r()("editPage.voiceSelectDefault")],re),ea(se,I),b(ae,Q)},ve=ae=>{var Q=cs(),se=a(Q,!0);t(Q),R(z=>n(se,z),[()=>r()("editPage.voiceLoading")],re),b(ae,Q)};H(T,ae=>{L().length>0?ae(ne):ae(ve,!1)})}t(v),R((ae,Q)=>{n(f,ae),n(P,Q)},[()=>r()("editPage.voiceLabel"),()=>r()("editPage.voiceDescription")],re),b(p,v)};H(Wt,p=>{(l().personaType=="3D"||l().personaType=="2.5D")&&l().contentType!=="story"&&p(oa)})}t(je),R((p,v,_)=>{n(Ne,p),n(lt,v),n(nt,_)},[()=>r()("editPage.mediaFiles"),()=>r()("editPage.profileImageLabel"),()=>r()("editPage.fileSelect")],re),ge("change",vt,Z),b(g,je),ra(),u()}var ps=x('<div class="kintsugi-fields svelte-58ku3i"><div class="form-group svelte-58ku3i"><label for="k-description" class="svelte-58ku3i"> </label> <p class="description svelte-58ku3i"> </p> <textarea id="k-description" rows="5" maxlength="1000" class="svelte-58ku3i"></textarea> <div> </div></div> <div class="form-group svelte-58ku3i"><label for="k-personality" class="svelte-58ku3i"> </label> <p class="description svelte-58ku3i"> </p> <textarea id="k-personality" rows="5" maxlength="1000" class="svelte-58ku3i"></textarea> <div> </div></div> <div class="form-group svelte-58ku3i"><label for="k-userPersona" class="svelte-58ku3i"> </label> <p class="description svelte-58ku3i"> </p> <textarea id="k-userPersona" rows="5" maxlength="800" class="svelte-58ku3i"></textarea> <div> </div></div> <div class="form-group svelte-58ku3i"><label for="k-scenario" class="svelte-58ku3i"> </label> <p class="description svelte-58ku3i"> </p> <textarea id="k-scenario" rows="2" maxlength="200" class="svelte-58ku3i"></textarea> <div> </div></div></div>');function ei(g,i){aa(i,!1);const[c,u]=sa(),r=()=>ia(la,"$t",c);let l=we(i,"k_description",12),y=we(i,"k_personality",12),L=we(i,"k_userPersona",12),I=we(i,"k_scenario",12);ta();var C=ps(),U=a(C),O=a(U),A=a(O,!0);t(O);var M=s(O,2),N=a(M,!0);t(M);var F=s(M,2);fe(F);var V=s(F,2);let J;var q=a(V);t(V),t(U);var G=s(U,2),W=a(G),te=a(W,!0);t(W);var X=s(W,2),K=a(X,!0);t(X);var B=s(X,2);fe(B);var Z=s(B,2);let oe;var be=a(Z);t(Z),t(G);var Ue=s(G,2),$e=a(Ue),at=a($e,!0);t($e);var Ie=s($e,2),rt=a(Ie,!0);t(Ie);var Pe=s(Ie,2);fe(Pe);var De=s(Pe,2);let Me;var kt=a(De);t(De),t(Ue);var st=s(Ue,2),je=a(st),it=a(je,!0);t(je);var Ne=s(je,2),Ce=a(Ne,!0);t(Ne);var Le=s(Ne,2);fe(Le);var lt=s(Le,2);let Fe;var ot=a(lt);t(lt),t(st),t(C),R((We,nt,vt,ft,ht,St,wt,Dt,ct,jt,dt,At,ut,pt,Ye,Tt)=>{n(A,We),n(N,nt),Y(F,"placeholder",vt),J=he(V,1,"char-counter svelte-58ku3i",null,J,ft),n(q,`${l().length??""} / 1000`),n(te,ht),n(K,St),Y(B,"placeholder",wt),oe=he(Z,1,"char-counter svelte-58ku3i",null,oe,Dt),n(be,`${y().length??""} / 1000`),n(at,ct),n(rt,jt),Y(Pe,"placeholder",dt),Me=he(De,1,"char-counter svelte-58ku3i",null,Me,At),n(kt,`${L().length??""} / 800`),n(it,ut),n(Ce,pt),Y(Le,"placeholder",Ye),Fe=he(lt,1,"char-counter svelte-58ku3i",null,Fe,Tt),n(ot,`${I().length??""} / 200`)},[()=>r()("editPage.kintsugi.descriptionLabel"),()=>r()("editPage.kintsugi.descriptionDesc"),()=>r()("editPage.kintsugi.descriptionPlaceholder"),()=>({warning:l().length>900,error:l().length>=1e3}),()=>r()("editPage.kintsugi.personalityLabel"),()=>r()("editPage.kintsugi.personalityDesc"),()=>r()("editPage.kintsugi.personalityPlaceholder"),()=>({warning:y().length>900,error:y().length>=1e3}),()=>r()("editPage.kintsugi.userPersonaLabel"),()=>r()("editPage.kintsugi.userPersonaDesc"),()=>r()("editPage.kintsugi.userPersonaPlaceholder"),()=>({warning:L().length>700,error:L().length>=800}),()=>r()("editPage.kintsugi.scenarioLabel"),()=>r()("editPage.kintsugi.scenarioDesc"),()=>r()("editPage.kintsugi.scenarioPlaceholder"),()=>({warning:I().length>180,error:I().length>=200})],re),pe(F,l),pe(B,y),pe(Pe,L),pe(Le,I),b(g,C),ra(),u()}var _s=x("<option> </option>"),gs=x('<div class="expression-item svelte-8r85u4"><label class="svelte-8r85u4"> </label> <select class="svelte-8r85u4"><option>(None)</option><!></select></div>'),ms=x(`<div class="form-section svelte-8r85u4"><h3 class="section-title svelte-8r85u4">ðŸŽ­ Expression Mapping</h3> <p class="section-desc svelte-8r85u4">Map standard emotions to your model's expression files.</p> <div class="expression-grid svelte-8r85u4"></div></div>`),fs=x('<div class="expression-item svelte-8r85u4" style="flex-direction: row; align-items: center; gap: 0.5rem; background: var(--muted); padding: 0.5rem; border-radius: 4px;"><input type="checkbox" style="width: auto; margin: 0;"/> <label style="margin: 0; cursor: pointer; font-size: 0.85rem; word-break: break-all;" class="svelte-8r85u4"> </label></div>'),hs=x('<div class="form-section svelte-8r85u4"><h3 class="section-title svelte-8r85u4">ðŸ”’ Permanent Expressions</h3> <p class="section-desc svelte-8r85u4">Select expressions to be always active (e.g. clothing toggles).</p> <div class="expression-grid svelte-8r85u4" style="grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));"></div></div>'),ws=x("<option> </option>"),bs=x('<optgroup label="Motions"></optgroup>'),xs=x("<option> </option>"),Es=x('<optgroup label="Expressions"></optgroup>'),Rs=x('<div class="motion-item svelte-8r85u4"><div class="motion-inputs svelte-8r85u4"><input class="input-name svelte-8r85u4" placeholder="Name (e.g. Laugh)"/> <select class="input-file svelte-8r85u4" title="Select Motion or Expression"><option disabled selected>Select Action File</option><!><!></select></div> <input class="input-desc svelte-8r85u4" placeholder="Description (e.g. Laughs out loud)"/> <button class="btn-remove svelte-8r85u4">&times;</button></div>'),ys=x('<div class="form-section svelte-8r85u4"><h3 class="section-title svelte-8r85u4">ðŸŽ¬ Animation List</h3> <p class="section-desc svelte-8r85u4">Create logical animations for the AI to use.</p> <div class="motion-list svelte-8r85u4"></div> <button class="btn-add svelte-8r85u4">+ Add Animation</button></div>'),Ps=x("<option> </option>"),Ls=x('<div class="expression-item svelte-8r85u4"><label class="svelte-8r85u4"> </label> <select class="svelte-8r85u4"><option> </option><!></select></div>'),ks=x(`<div class="form-section svelte-8r85u4"><h3 class="section-title svelte-8r85u4">ðŸ‘† Hit Reaction Mapping</h3> <p class="section-desc svelte-8r85u4">Choose motions to play when the user touches/clicks specific
                areas.</p> <div class="expression-grid svelte-8r85u4"></div></div>`),Ss=x('<div class="first-scene-builder svelte-8r85u4"><div class="builder-header svelte-8r85u4"><span class="builder-title svelte-8r85u4"> </span> <div class="builder-actions svelte-8r85u4"><button type="button" class="btn-util svelte-8r85u4"> </button></div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="3" maxlength="1000" class="svelte-8r85u4"></textarea> <div> </div></div> <!> <!> <!> <!> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="2" maxlength="500" class="svelte-8r85u4"></textarea> <div> </div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="2" maxlength="500" class="svelte-8r85u4"></textarea> <div> </div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="3" maxlength="1000" class="svelte-8r85u4"></textarea> <div> </div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="2" maxlength="500" class="svelte-8r85u4"></textarea> <div> </div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="4" maxlength="2000" class="svelte-8r85u4"></textarea> <div> </div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="2" maxlength="500" class="svelte-8r85u4"></textarea> <div> </div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="3" maxlength="1000" class="svelte-8r85u4"></textarea> <div> </div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="2" maxlength="300" class="svelte-8r85u4"></textarea> <div> </div></div> <div class="form-group svelte-8r85u4"><div class="field-label svelte-8r85u4"><span class="label-text svelte-8r85u4"> </span> <span class="label-hint svelte-8r85u4"> </span></div> <textarea rows="2" maxlength="200" class="svelte-8r85u4"></textarea> <div> </div></div></div>');function ti(g,i){aa(i,!1);const[c,u]=sa(),r=()=>ia(la,"$t",c),l=Pa();let y=we(i,"initialData",8,null),L=we(i,"onChange",8,()=>{}),I=we(i,"availableExpressions",24,()=>[]),C=we(i,"availableMotions",24,()=>[]),U=we(i,"mode",8,"live2d"),O=k(""),A=k(""),M=k(""),N=k(""),F=k(""),V=k(""),J=k(""),q=k(""),G=k(""),W=k(""),te=k(""),X=k(""),K=k({ELATED:"",GENTLE:"",STERN:"",DEPRESSED:"",TENSE:"",ASTONISHED:"",CALM:""}),B=k([]),Z=k({Body:"",Head:""}),oe=k([]),be=k(!1);function Ue(){let d="";e(B).length>0?d=e(B).map(ce=>`[${ce.name}] : ${ce.desc}`).join(`
`):d=e(A),d+=`
[NOD] : Nodding (Permission, Agreement)
[SHAKE] : Shaking head (Denial, Refusal)
[TILT] : Tilting head (Question, Doubt)
[FIDGET] : Fidgeting (Anxiety, Restlessness)
[SIGH] : Sighing (Relief, Disappointment, Tiredness)
[LOOK_DOWN] : Looking down (Shame, Submission, Sadness)
[CLOSE_EYES] : Closing eyes (Thinking, Refusal, Sleepy)
[WINK] : Winking (Teasing, Secret, Agreement)
[STICK_TONGUE] : Sticking tongue out (Teasing, Disgust)
[SQUINT] : Squinting (Suspicion, Focus, Glare)
[LOOK_UP_THINK] : Looking up (Thinking, Remembering)
[FLINCH] : Flinching (Surprise, Fear, Pain)
[PANT] : Panting (Exhaustion, Excitement, Heat)
`;const m={body_desc:e(O),anim_list:d,core_desire:e(M),contradiction:e(N),personality:e(F),values:e(V),mem_list:e(J),emotion_triggers:e(q),short_term_memory:e(G),last_atmosphere:e(W),current_emotion:e(te),internal_monologue:e(X),live2d_expression_map:e(K),live2d_motion_list:e(B),live2d_hit_motion_map:e(Z),live2d_permanent_expressions:e(oe)},E=JSON.stringify(m,null,2);L()(E),l("change",E)}function $e(){o(O,""),o(A,""),o(M,""),o(N,""),o(F,""),o(V,""),o(J,""),o(q,""),o(G,""),o(W,""),o(te,""),o(X,""),o(K,{ELATED:"",GENTLE:"",STERN:"",DEPRESSED:"",TENSE:"",ASTONISHED:"",CALM:""}),o(B,[]),o(Z,{Body:"",Head:""}),o(oe,[]),Ue()}Ba(()=>{if(y())try{let d;if(typeof y()=="object")d=y();else if(typeof y()=="string")d=JSON.parse(y());else throw new Error("Invalid initialData type");if(o(O,d.body_desc??""),o(A,d.anim_list??""),o(M,d.core_desire??""),o(N,d.contradiction??""),o(F,d.personality??""),o(V,d.values??""),o(J,d.mem_list??""),o(q,d.emotion_triggers??""),o(G,d.short_term_memory??""),o(W,d.last_atmosphere??""),o(te,d.current_emotion??""),o(X,d.internal_monologue??""),d.live2d_expression_map){const m=d.live2d_expression_map,E={...e(K)};Object.keys(E).forEach(ce=>{m[ce]&&(E[ce]=m[ce])}),m.joy&&(E.GENTLE=m.joy),m.happy&&(E.GENTLE=m.happy),m.fun&&(E.ELATED=m.fun),m.amuse&&(E.ELATED=m.amuse),m.anger&&(E.STERN=m.anger),m.sorrow&&(E.DEPRESSED=m.sorrow),m.surprise&&(E.ASTONISHED=m.surprise),m.unease&&(E.TENSE=m.unease),m.neutral&&(E.CALM=m.neutral),o(K,E)}Array.isArray(d.live2d_motion_list)&&o(B,d.live2d_motion_list),d.live2d_hit_motion_map&&o(Z,{...e(Z),...d.live2d_hit_motion_map}),Array.isArray(d.live2d_permanent_expressions)&&o(oe,d.live2d_permanent_expressions),o(be,!0)}catch(d){console.error("FirstSceneBuilder: initialData parse error",d);const m=E=>{const ce=new RegExp(`"${E}"\\s*:\\s*"((?:[^"\\\\]|\\\\.)*)"`),S=y().match(ce);return S&&S[1]?S[1].replace(/\\n/g,`
`).replace(/\\"/g,'"').replace(/\\\\/g,"\\"):""};o(O,m("body_desc")),o(A,m("anim_list")),o(M,m("core_desire")),o(N,m("contradiction")),o(F,m("personality")),o(V,m("values")),o(J,m("mem_list")),o(q,m("emotion_triggers")),o(G,m("short_term_memory")),o(W,m("last_atmosphere")),o(te,m("current_emotion")),o(X,m("internal_monologue")),o(be,!0)}else o(be,!0)});function at(){const d=C().length>0?C()[0]:I().length>0?I()[0]:"";o(B,[...e(B),{name:"",file:d,desc:""}])}function Ie(d){o(B,e(B).filter((m,E)=>E!==d))}function rt(d){e(oe).includes(d)?o(oe,e(oe).filter(m=>m!==d)):o(oe,[...e(oe),d])}Ha(()=>(e(O),e(A),e(M),e(N),e(F),e(V),e(J),e(q),e(G),e(W),e(te),e(X),e(K),e(B),e(Z),e(oe),e(be)),()=>{e(O),e(A),e(M),e(N),e(F),e(V),e(J),e(q),e(G),e(W),e(te),e(X),e(K),e(B),e(Z),e(oe),e(be)&&Ue()}),Va(),ta();var Pe=Ss(),De=a(Pe),Me=a(De),kt=a(Me);t(Me);var st=s(Me,2),je=a(st),it=a(je,!0);t(je),t(st),t(De);var Ne=s(De,2),Ce=a(Ne),Le=a(Ce),lt=a(Le,!0);t(Le);var Fe=s(Le,2),ot=a(Fe,!0);t(Fe),t(Ce);var We=s(Ce,2);fe(We);var nt=s(We,2);let vt;var ft=a(nt);t(nt),t(Ne);var ht=s(Ne,2);{var St=d=>{var m=ms(),E=s(a(m),4);Oe(E,5,()=>Object.keys(e(K)),Ke,(ce,S)=>{var ee=gs(),le=a(ee),xe=a(le,!0);t(le);var de=s(le,2);R(()=>{e(K),ze(()=>{e(S),I()})});var ue=a(de);ue.value=ue.__value="";var qe=s(ue);Oe(qe,1,I,Ke,(Ee,ke)=>{var Re=_s(),Se={},tt=a(Re,!0);t(Re),R(()=>{Se!==(Se=e(ke))&&(Re.value=(Re.__value=e(ke))??""),n(tt,e(ke))}),b(Ee,Re)}),t(de),t(ee),R(Ee=>{Y(le,"for",`expr-${e(S)??""}`),n(xe,Ee),Y(de,"id",`expr-${e(S)??""}`)},[()=>e(S).charAt(0).toUpperCase()+e(S).slice(1)],re),ea(de,()=>e(K)[e(S)],Ee=>$a(K,e(K)[e(S)]=Ee)),b(ce,ee)}),t(E),t(m),b(d,m)};H(ht,d=>{U()==="live2d"&&I().length>0&&d(St)})}var wt=s(ht,2);{var Dt=d=>{var m=hs(),E=s(a(m),4);Oe(E,5,I,Ke,(ce,S)=>{var ee=fs(),le=a(ee);Zt(le);var xe=s(le,2),de=a(xe,!0);t(xe),t(ee),R(ue=>{Y(le,"id",`perm-${e(S)??""}`),kr(le,ue),Y(xe,"for",`perm-${e(S)??""}`),n(de,e(S))},[()=>e(oe).includes(e(S))],re),ge("change",le,()=>rt(e(S))),b(ce,ee)}),t(E),t(m),b(d,m)};H(wt,d=>{U()==="live2d"&&I().length>0&&d(Dt)})}var ct=s(wt,2);{var jt=d=>{var m=ys(),E=s(a(m),4);Oe(E,5,()=>e(B),Ke,(S,ee,le)=>{var xe=Rs(),de=a(xe),ue=a(de);Zt(ue);var qe=s(ue,2);R(()=>{e(ee),ze(()=>{C(),I()})});var Ee=a(qe);Ee.value=Ee.__value="";var ke=s(Ee);{var Re=me=>{var Ge=bs();Oe(Ge,5,C,Ke,(Ct,Xe)=>{var ye=ws(),gt={},Ft=a(ye,!0);t(ye),R(ya=>{gt!==(gt=e(Xe))&&(ye.value=(ye.__value=e(Xe))??""),n(Ft,ya)},[()=>e(Xe).split("/").pop()],re),b(Ct,ye)}),t(Ge),b(me,Ge)};H(ke,me=>{C().length>0&&me(Re)})}var Se=s(ke);{var tt=me=>{var Ge=Es();Oe(Ge,5,I,Ke,(Ct,Xe)=>{var ye=xs(),gt={},Ft=a(ye);t(ye),R(()=>{gt!==(gt=e(Xe))&&(ye.value=(ye.__value=e(Xe))??""),n(Ft,`${e(Xe)??""} (Expression)`)}),b(Ct,ye)}),t(Ge),b(me,Ge)};H(Se,me=>{I().length>0&&me(tt)})}t(qe),t(de);var _t=s(de,2);Zt(_t);var Nt=s(_t,2);t(xe),pe(ue,()=>e(ee).name,me=>(e(ee).name=me,ze(()=>e(B)))),ea(qe,()=>e(ee).file,me=>(e(ee).file=me,ze(()=>e(B)))),pe(_t,()=>e(ee).desc,me=>(e(ee).desc=me,ze(()=>e(B)))),ge("click",Nt,()=>Ie(le)),b(S,xe)}),t(E);var ce=s(E,2);t(m),ge("click",ce,at),b(d,m)};H(ct,d=>{U()==="live2d"&&(C().length>0||I().length>0)&&d(jt)})}var dt=s(ct,2);{var At=d=>{var m=ks(),E=s(a(m),4);Oe(E,5,()=>Object.keys(e(Z)),Ke,(ce,S)=>{var ee=Ls(),le=a(ee),xe=a(le,!0);t(le);var de=s(le,2);R(()=>{e(Z),ze(()=>{e(S),C()})});var ue=a(de);ue.value=ue.__value="";var qe=a(ue);t(ue);var Ee=s(ue);Oe(Ee,1,C,Ke,(ke,Re)=>{var Se=Ps(),tt={},_t=a(Se,!0);t(Se),R(Nt=>{tt!==(tt=e(Re))&&(Se.value=(Se.__value=e(Re))??""),n(_t,Nt)},[()=>e(Re).split("/").pop()],re),b(ke,Se)}),t(de),t(ee),R(()=>{Y(le,"for",`hit-${e(S)??""}`),n(xe,e(S)),Y(de,"id",`hit-${e(S)??""}`),n(qe,`(Default: Tap${e(S)??""})`)}),ea(de,()=>e(Z)[e(S)],ke=>$a(Z,e(Z)[e(S)]=ke)),b(ce,ee)}),t(E),t(m),b(d,m)};H(dt,d=>{C().length>0&&d(At)})}var ut=s(dt,2),pt=a(ut),Ye=a(pt),Tt=a(Ye,!0);t(Ye);var Wt=s(Ye,2),oa=a(Wt,!0);t(Wt),t(pt);var p=s(pt,2);fe(p);var v=s(p,2);let _;var f=a(v);t(v),t(ut);var h=s(ut,2),P=a(h),T=a(P),ne=a(T,!0);t(T);var ve=s(T,2),ae=a(ve,!0);t(ve),t(P);var Q=s(P,2);fe(Q);var se=s(Q,2);let z;var w=a(se);t(se),t(h);var j=s(h,2),ie=a(j),Ae=a(ie),Be=a(Ae,!0);t(Ae);var Je=s(Ae,2),Ut=a(Je,!0);t(Je),t(ie);var He=s(ie,2);fe(He);var bt=s(He,2);let Bt;var Ht=a(bt);t(bt),t(j);var xt=s(j,2),Qe=a(xt),Et=a(Qe),Ot=a(Et,!0);t(Et);var Rt=s(Et,2),Vt=a(Rt,!0);t(Rt),t(Qe);var Ze=s(Qe,2);fe(Ze);var $t=s(Ze,2);let It;var qt=a($t);t($t),t(xt);var yt=s(xt,2),Mt=a(yt),et=a(Mt),na=a(et,!0);t(et);var Gt=s(et,2),va=a(Gt,!0);t(Gt),t(Mt);var Pt=s(Mt,2);fe(Pt);var $=s(Pt,2);let _e;var Ve=a($);t($),t(yt);var Te=s(yt,2),ca=a(Te),da=a(ca),qa=a(da,!0);t(da);var La=s(da,2),Ga=a(La,!0);t(La),t(ca);var Xt=s(ca,2);fe(Xt);var ua=s(Xt,2);let ka;var Xa=a(ua);t(ua),t(Te);var pa=s(Te,2),_a=a(pa),ga=a(_a),Ka=a(ga,!0);t(ga);var Sa=s(ga,2),za=a(Sa,!0);t(Sa),t(_a);var Kt=s(_a,2);fe(Kt);var ma=s(Kt,2);let Da;var Ya=a(ma);t(ma),t(pa);var fa=s(pa,2),ha=a(fa),wa=a(ha),Ja=a(wa,!0);t(wa);var ja=s(wa,2),Qa=a(ja,!0);t(ja),t(ha);var zt=s(ha,2);fe(zt);var ba=s(zt,2);let Aa;var Za=a(ba);t(ba),t(fa);var Ta=s(fa,2),xa=a(Ta),Ea=a(xa),er=a(Ea,!0);t(Ea);var Ua=s(Ea,2),tr=a(Ua,!0);t(Ua),t(xa);var Yt=s(xa,2);fe(Yt);var Ra=s(Yt,2);let Oa;var ar=a(Ra);t(Ra),t(Ta),t(Pe),R((d,m,E,ce,S,ee,le,xe,de,ue,qe,Ee,ke,Re,Se,tt,_t,Nt,me,Ge,Ct,Xe,ye,gt,Ft,ya,rr,sr,ir,lr,or,nr,vr,cr,dr,ur,pr,_r,gr,mr,fr,hr)=>{n(kt,`ðŸ“ ${d??""}`),n(it,m),n(lt,E),n(ot,ce),Y(We,"placeholder",S),vt=he(nt,1,"char-counter svelte-8r85u4",null,vt,ee),n(ft,`${e(O).length??""} / 1000`),n(Tt,le),n(oa,xe),Y(p,"placeholder",de),_=he(v,1,"char-counter svelte-8r85u4",null,_,ue),n(f,`${e(M).length??""} / 500`),n(ne,qe),n(ae,Ee),Y(Q,"placeholder",ke),z=he(se,1,"char-counter svelte-8r85u4",null,z,Re),n(w,`${e(N).length??""} / 500`),n(Be,Se),n(Ut,tt),Y(He,"placeholder",_t),Bt=he(bt,1,"char-counter svelte-8r85u4",null,Bt,Nt),n(Ht,`${e(F).length??""} / 1000`),n(Ot,me),n(Vt,Ge),Y(Ze,"placeholder",Ct),It=he($t,1,"char-counter svelte-8r85u4",null,It,Xe),n(qt,`${e(V).length??""} / 500`),n(na,ye),n(va,gt),Y(Pt,"placeholder",Ft),_e=he($,1,"char-counter svelte-8r85u4",null,_e,ya),n(Ve,`${e(J).length??""} / 2000`),n(qa,rr),n(Ga,sr),Y(Xt,"placeholder",ir),ka=he(ua,1,"char-counter svelte-8r85u4",null,ka,lr),n(Xa,`${e(q).length??""} / 500`),n(Ka,or),n(za,nr),Y(Kt,"placeholder",vr),Da=he(ma,1,"char-counter svelte-8r85u4",null,Da,cr),n(Ya,`${e(G).length??""} / 1000`),n(Ja,dr),n(Qa,ur),Y(zt,"placeholder",pr),Aa=he(ba,1,"char-counter svelte-8r85u4",null,Aa,_r),n(Za,`${e(W).length??""} / 300`),n(er,gr),n(tr,mr),Y(Yt,"placeholder",fr),Oa=he(Ra,1,"char-counter svelte-8r85u4",null,Oa,hr),n(ar,`${e(te).length??""} / 200`)},[()=>r()("editPage.characterSettings.title"),()=>r()("editPage.characterSettings.reset"),()=>r()("editPage.characterSettings.bodyDesc"),()=>r()("editPage.characterSettings.bodyDescHint"),()=>r()("editPage.characterSettings.bodyDescPlaceholder"),()=>({warning:e(O).length>800,error:e(O).length>=1e3}),()=>r()("editPage.characterSettings.coreDesire"),()=>r()("editPage.characterSettings.coreDesireHint"),()=>r()("editPage.characterSettings.coreDesirePlaceholder"),()=>({warning:e(M).length>400,error:e(M).length>=500}),()=>r()("editPage.characterSettings.contradiction"),()=>r()("editPage.characterSettings.contradictionHint"),()=>r()("editPage.characterSettings.contradictionPlaceholder"),()=>({warning:e(N).length>400,error:e(N).length>=500}),()=>r()("editPage.characterSettings.personality"),()=>r()("editPage.characterSettings.personalityHint"),()=>r()("editPage.characterSettings.personalityPlaceholder"),()=>({warning:e(F).length>800,error:e(F).length>=1e3}),()=>r()("editPage.characterSettings.values"),()=>r()("editPage.characterSettings.valuesHint"),()=>r()("editPage.characterSettings.valuesPlaceholder"),()=>({warning:e(V).length>400,error:e(V).length>=500}),()=>r()("editPage.characterSettings.memList"),()=>r()("editPage.characterSettings.memListHint"),()=>r()("editPage.characterSettings.memListPlaceholder"),()=>({warning:e(J).length>1800,error:e(J).length>=2e3}),()=>r()("editPage.characterSettings.emotionTriggers"),()=>r()("editPage.characterSettings.emotionTriggersHint"),()=>r()("editPage.characterSettings.emotionTriggersPlaceholder"),()=>({warning:e(q).length>400,error:e(q).length>=500}),()=>r()("editPage.characterSettings.shortTermMemory"),()=>r()("editPage.characterSettings.shortTermMemoryHint"),()=>r()("editPage.characterSettings.shortTermMemoryPlaceholder"),()=>({warning:e(G).length>800,error:e(G).length>=1e3}),()=>r()("editPage.characterSettings.lastAtmosphere"),()=>r()("editPage.characterSettings.lastAtmosphereHint"),()=>r()("editPage.characterSettings.lastAtmospherePlaceholder"),()=>({warning:e(W).length>250,error:e(W).length>=300}),()=>r()("editPage.characterSettings.currentEmotion"),()=>r()("editPage.characterSettings.currentEmotionHint"),()=>r()("editPage.characterSettings.currentEmotionPlaceholder"),()=>({warning:e(te).length>180,error:e(te).length>=200})],re),ge("click",je,$e),pe(We,()=>e(O),d=>o(O,d)),pe(p,()=>e(M),d=>o(M,d)),pe(Q,()=>e(N),d=>o(N,d)),pe(He,()=>e(F),d=>o(F,d)),pe(Ze,()=>e(V),d=>o(V,d)),pe(Pt,()=>e(J),d=>o(J,d)),pe(Xt,()=>e(q),d=>o(q,d)),pe(Kt,()=>e(G),d=>o(G,d)),pe(zt,()=>e(W),d=>o(W,d)),pe(Yt,()=>e(te),d=>o(te,d)),b(g,Pe),ra(),u()}export{ti as F,ei as K,Zs as M,Qs as a};
