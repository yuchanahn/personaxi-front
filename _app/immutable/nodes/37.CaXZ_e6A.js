import{d as u,b as v,e as sa,t as fa}from"../chunks/kz80bbCR.js";import{i as Ae}from"../chunks/2r1cYJse.js";import{c as oa,o as Sa,a as ss}from"../chunks/D0mpzbhj.js";import{w as Fe,al as e,am as t,ap as s,Q as a,W as $,aj as M,V as i,z as Le,aq as Ee,ao as ra,ar as Ma,as as We,an as ua,O as F,I as Be,aD as qe}from"../chunks/BUDlkbfV.js";import{s as o}from"../chunks/BbnaKca8.js";import{i as b}from"../chunks/28pso2Hb.js";import{e as Ke,i as pa}from"../chunks/BOGOvxWJ.js";import{r as ia,s as na,a as yt,b as ds}from"../chunks/BJyhluUY.js";import{e as d}from"../chunks/CiCNsvIE.js";import{b as _a,a as us}from"../chunks/njKOc8Q7.js";import{s as Pa,a as fs}from"../chunks/BqlTOgs2.js";import{b as Na}from"../chunks/BP_wOmgt.js";import{s as Te,a as Ft,d as Ta}from"../chunks/D32zTIdM.js";import{g as xe}from"../chunks/DqiWXVxP.js";import{g as qa}from"../chunks/-np-DA1K.js";import{a as ps,l as _s}from"../chunks/-4D0oWvs.js";import{a as Re}from"../chunks/E07TNQLR.js";import{$ as ke,a as Ia}from"../chunks/C36u96xB.js";import{p as me}from"../chunks/Bf5_DoVm.js";import{c as ms}from"../chunks/DGRjBuv2.js";import{t as Je,a as rs,f as ka,b as bs}from"../chunks/B2SxtloT.js";import{I as w}from"../chunks/DaDtKPX8.js";import{N as Da}from"../chunks/kAk1PkLC.js";import{g as xa}from"../chunks/e6l8DgL1.js";import{t as le}from"../chunks/sXlFIKQv.js";import{g as hs,u as gs}from"../chunks/Caezn3U5.js";import{s as $a}from"../chunks/3azsccOw.js";import{c as ys}from"../chunks/CmEqjr1-.js";import{s as aa}from"../chunks/IXAamO68.js";import{d as ws,a as xs,b as qs,g as is,e as Ka,u as ks,f as $s}from"../chunks/CIhK29i5.js";import{s as Ms}from"../chunks/C-VEydUt.js";import{c as Ps}from"../chunks/DMOjeqFW.js";import{A as Cs}from"../chunks/DxUrSklm.js";import{n as $e}from"../chunks/BlC4O2HE.js";import{n as Rs}from"../chunks/CpY9QRO1.js";import{C as es}from"../chunks/CBbSIjb6.js";import{e as Es,d as As}from"../chunks/JtpDz4mb.js";async function Fs(X){if(!(typeof window>"u")){if(!window.PortOne){le.error("인증 모듈을 불러오는 중입니다. 잠시 후 다시 시도해주세요.");return}try{const q=await window.PortOne.requestIdentityVerification({storeId:"store-04392323-c1ba-4c80-9812-ae8577171bb0",identityVerificationId:`identity-verification-${crypto.randomUUID()}`,channelKey:"channel-key-b5e31a4c-6742-49b8-a62c-e4ec792113b2"});if(q.code!=null){console.error("Verification Error:",q),le.error(q.message||"본인인증 실패"),X?.onError?.(q);return}if((await Re.post("/api/identity-verifications",{identityVerificationId:q.identityVerificationId})).ok){le.success("본인인증이 완료되었습니다!");const ft=await qa();if(ft){const n=ft;$a.set(n)}X?.onSuccess?.()}else le.error("인증 정보 저장에 실패했습니다."),X?.onError?.(new Error("Failed to save verification data"))}catch(q){console.error("Verification Exception:",q),le.error("본인인증 중 오류가 발생했습니다."),X?.onError?.(q)}}}const Ls="/api/live";async function as(){const X=await Re.get2(`${Ls}/list`);if(!X.ok)throw new Error("live.fetchListFailed");const q=await X.json();if(!Array.isArray(q))throw new Error("live.responseNotArray");return q}var Ts=u('<p class="error svelte-lquz3j"> </p>'),Is=u('<div class="modal-backdrop svelte-lquz3j"><div class="modal svelte-lquz3j"><h2> </h2> <label>Starting Bid (Credits): <input type="number" min="1" class="svelte-lquz3j"/></label> <label>Duration (seconds): <input type="number" min="60" class="svelte-lquz3j"/></label> <!> <div class="buttons svelte-lquz3j"><button class="svelte-lquz3j">Create Auction</button> <button class="svelte-lquz3j">Cancel</button></div></div></div>');function Ss(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft(ke,"$t",G);let m=me(q,"persona",8);const rt=oa();let N=$(100),dt=$(300),P=$("");async function l(){try{await ms(m().id,a(N),a(dt)),rt("close")}catch(R){i(P,R.message||n()("auctionModal.createFailed"))}}Ae();var p=Is(),g=e(p),A=e(g),B=e(A);t(A);var O=s(A,2),W=s(e(O));ia(W),t(O);var et=s(O,2),T=s(e(et));ia(T),t(et);var D=s(et,2);{var k=R=>{var S=Ts(),Q=e(S,!0);t(S),M(()=>o(Q,a(P))),v(R,S)};b(D,R=>{a(P)&&R(k)})}var I=s(D,2),y=e(I),C=s(y,2);t(I),t(g),t(p),M(()=>o(B,`Start Auction for ${m().name??""}`)),_a(W,()=>a(N),R=>i(N,R)),_a(T,()=>a(dt),R=>i(dt,R)),d("click",y,l),d("click",C,()=>rt("close")),v(X,p),Le(),ft()}var Ds=u('<button class="max-btn svelte-1yqfh4s"> </button>'),Ns=u('<p class="error-msg svelte-1yqfh4s"> </p>'),Os=u('<p class="error-msg svelte-1yqfh4s"> </p>'),Hs=u('<div class="modal-backdrop svelte-1yqfh4s"><div class="modal-content svelte-1yqfh4s"><div class="modal-header svelte-1yqfh4s"><h3 class="svelte-1yqfh4s"> </h3> <button class="close-btn svelte-1yqfh4s"><!></button></div> <div class="modal-body svelte-1yqfh4s"><div class="info-box svelte-1yqfh4s"><p class="info-title svelte-1yqfh4s"><!> </p> <p class="info-text svelte-1yqfh4s"> </p></div> <div class="input-section svelte-1yqfh4s"><div class="label-row svelte-1yqfh4s"><span class="svelte-1yqfh4s"> </span> <span class="max-text svelte-1yqfh4s"> </span></div> <div class="input-wrapper svelte-1yqfh4s"><input type="number" placeholder="0" min="0" step="0.01"/> <div class="suffix svelte-1yqfh4s"><!> <span class="unit svelte-1yqfh4s">P</span></div></div> <!></div> <div class="summary-card svelte-1yqfh4s"><div class="summary-row svelte-1yqfh4s"><span class="svelte-1yqfh4s"> </span> <span class="svelte-1yqfh4s"></span></div> <div class="summary-row svelte-1yqfh4s"><span class="svelte-1yqfh4s"> </span> <span class="fee-text svelte-1yqfh4s"> </span></div> <div class="divider svelte-1yqfh4s"></div> <div class="summary-row total svelte-1yqfh4s"><span class="svelte-1yqfh4s"> </span> <span class="total-text svelte-1yqfh4s"> <!></span></div></div></div> <div class="modal-footer svelte-1yqfh4s"><button class="btn-cancel svelte-1yqfh4s"> </button> <button class="btn-confirm svelte-1yqfh4s"><!></button></div></div></div>');function Us(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft(ke,"$t",G),m=$(),rt=$(),N=$();let dt=me(q,"isOpen",8,!1),P=me(q,"userPoints",8,0);const l=oa();let p=$(null),g=$(!1);const A=0,B=1,O=1;function W(){l("close"),i(p,null)}async function et(){!a(N)||!a(p)||(i(g,!0),l("confirm",{amount:a(p)}),i(g,!1),W())}Ee(()=>a(p),()=>{i(m,a(p)?a(p)*A:0)}),Ee(()=>(a(p),a(m)),()=>{i(rt,a(p)?Math.floor((a(p)-a(m))*B):0)}),Ee(()=>(a(p),ra(P())),()=>{i(N,a(p)&&Math.floor(a(p))>=O&&a(p)<=P())}),Ma(),Ae();var T=sa(),D=We(T);{var k=I=>{var y=Hs(),C=e(y),R=e(C),S=e(R),Q=e(S,!0);t(S);var Y=s(S,2),L=e(Y);w(L,{icon:"ph:x-bold"}),t(Y),t(R);var c=s(R,2),E=e(c),H=e(E),j=e(H);w(j,{icon:"ph:info-duotone"});var it=s(j);t(H);var at=s(H,2),z=e(at,!0);t(at),t(E);var nt=s(E,2),jt=e(nt),zt=e(jt),Vt=e(zt,!0);t(zt);var K=s(zt,2),Lt=e(K);t(K),t(jt);var Tt=s(jt,2),lt=e(Tt);ia(lt);let bt;var Ct=s(lt,2),wt=e(Ct);{var Jt=_=>{var V=Ds(),ot=e(V,!0);t(V),M($t=>o(ot,$t),[()=>n()("pointConvertModal.max")],F),d("click",V,()=>i(p,P())),v(_,V)};b(wt,_=>{P()>0&&a(p)!==P()&&_(Jt)})}ua(2),t(Ct),t(Tt);var Bt=s(Tt,2);{var Gt=_=>{var V=Ns(),ot=e(V,!0);t(V),M($t=>o(ot,$t),[()=>n()("pointConvertModal.insufficientPoints")],F),v(_,V)},be=(_,V)=>{{var ot=$t=>{var Mt=Os(),Qt=e(Mt,!0);t(Mt),M(ge=>o(Qt,ge),[()=>n()("pointConvertModal.minAmountError",{values:{min:O}})],F),v($t,Mt)};b(_,$t=>{a(p)&&Math.floor(a(p))<O&&$t(ot)},V)}};b(Bt,_=>{a(p)&&a(p)>P()?_(Gt):_(be,!1)})}t(nt);var Yt=s(nt,2),xt=e(Yt),Zt=e(xt),te=e(Zt,!0);t(Zt);var It=s(Zt,2);It.textContent="1 P = 1 Neuron",t(xt);var ee=s(xt,2),ue=e(ee),fe=e(ue,!0);t(ue);var Ie=s(ue,2),Me=e(Ie);t(Ie),t(ee);var Se=s(ee,4),qt=e(Se),Wt=e(qt,!0);t(qt);var pe=s(qt,2),Pe=e(pe),ae=s(Pe);Da(ae,{size:18,color:"currentColor"}),t(pe),t(Se),t(Yt),t(c);var ve=s(c,2),St=e(ve),he=e(St,!0);t(St);var se=s(St,2),kt=e(se);{var ht=_=>{w(_,{icon:"ph:spinner-bold",class:"spin"})},Rt=_=>{var V=fa();M(ot=>o(V,ot),[()=>n()("pointConvertModal.convertAction")],F),v(_,V)};b(kt,_=>{a(g)?_(ht):_(Rt,!1)})}t(se),t(ve),t(C),t(y),M((_,V,ot,$t,Mt,Qt,ge,_e,De,Ge,Ne)=>{o(Q,_),o(it,` ${V??""}`),o(z,ot),o(Vt,$t),o(Lt,`${Mt??""}: ${Qt??""} P`),na(lt,"max",P()),bt=yt(lt,1,"svelte-1yqfh4s",null,bt,ge),o(te,_e),o(fe,De),o(Me,`-${a(m)??""} P`),o(Wt,Ge),o(Pe,`+${a(rt)??""} `),o(he,Ne),se.disabled=!a(N)||a(g)},[()=>n()("pointConvertModal.title"),()=>n()("pointConvertModal.infoTitle"),()=>n()("pointConvertModal.infoDesc"),()=>n()("pointConvertModal.convertAmount"),()=>n()("pointConvertModal.max"),()=>P().toFixed(2),()=>({"has-value":a(p)&&a(p)>0}),()=>n()("pointConvertModal.exchangeRate"),()=>n()("pointConvertModal.fee"),()=>n()("pointConvertModal.receiveAmount"),()=>n()("common.cancel")],F),d("click",Y,W),_a(lt,()=>a(p),_=>i(p,_)),d("click",St,W),d("click",se,et),Je(3,C,()=>rs,()=>({y:-14,duration:220})),d("click",C,Pa(function(_){Na.call(this,q,_)})),d("click",y,W),Je(3,y,()=>ka,()=>({duration:160})),v(I,y)};b(D,I=>{dt()&&I(k)})}v(X,T),Le(),ft()}var js=u('<div class="modal-backdrop svelte-1phi9s4"><div class="modal-content svelte-1phi9s4"><button class="close-button svelte-1phi9s4">&times;</button> <h2 class="svelte-1phi9s4"> </h2> <p class="description svelte-1phi9s4"> </p> <div class="setting-group svelte-1phi9s4"><label class="svelte-1phi9s4"> </label> <div class="button-group svelte-1phi9s4"><button> </button> <button> </button></div></div> <div class="setting-group svelte-1phi9s4"><label class="svelte-1phi9s4"> </label> <div class="button-group svelte-1phi9s4"><button><!> </button> <button><!> </button></div></div> <div class="delete-account-section svelte-1phi9s4"><button class="delete-button svelte-1phi9s4"><!> </button></div></div></div>');function zs(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft(ke,"$t",G),m=()=>Ft(aa,"$settings",G);let rt=me(q,"isOpen",12,!1);const N=oa();function dt(){rt(!1),N("close")}async function P(){await Ps.ask(n()("settingPageModal.deleteAccountConfirm"),{type:"danger",confirmText:"Delete"})&&(await ws()?(await Ms.auth.signOut(),ps.set(null),le.success(n()("settingPageModal.deleteAccountSuccess")),window.location.href="/"):le.error(n()("settingPageModal.deleteAccountFail")))}function l(B){rt()&&B.key==="Escape"&&dt()}Sa(()=>{window.addEventListener("keydown",l)}),ss(()=>{window.removeEventListener("keydown",l)}),Ae();var p=sa(),g=We(p);{var A=B=>{var O=js(),W=e(O),et=e(W),T=s(et,2),D=e(T,!0);t(T);var k=s(T,2),I=e(k,!0);t(k);var y=s(k,2),C=e(y),R=e(C,!0);t(C);var S=s(C,2),Q=e(S);let Y;var L=e(Q,!0);t(Q);var c=s(Q,2);let E;var H=e(c,!0);t(c),t(S),t(y);var j=s(y,2),it=e(j),at=e(it,!0);t(it);var z=s(it,2),nt=e(z);let jt;var zt=e(nt);w(zt,{icon:"ph:sun-bold"});var Vt=s(zt);t(nt);var K=s(nt,2);let Lt;var Tt=e(K);w(Tt,{icon:"ph:moon-bold"});var lt=s(Tt);t(K),t(z),t(j);var bt=s(j,2),Ct=e(bt),wt=e(Ct);w(wt,{icon:"ph:trash-bold"});var Jt=s(wt);t(Ct),t(bt),t(W),t(O),M((Bt,Gt,be,Yt,xt,Zt,te,It,ee,ue,fe,Ie,Me)=>{o(D,Bt),o(I,Gt),o(R,be),Y=yt(Q,1,"svelte-1phi9s4",null,Y,Yt),o(L,xt),E=yt(c,1,"svelte-1phi9s4",null,E,Zt),o(H,te),o(at,It),jt=yt(nt,1,"svelte-1phi9s4",null,jt,ee),o(Vt,` ${ue??""}`),Lt=yt(K,1,"svelte-1phi9s4",null,Lt,fe),o(lt,` ${Ie??""}`),o(Jt,` ${Me??""}`)},[()=>n()("settingPageModal.title"),()=>n()("settingPageModal.description"),()=>n()("settingPageModal.language"),()=>({active:m().language==="ko"}),()=>n()("settingPageModal.korean"),()=>({active:m().language==="en"}),()=>n()("settingPageModal.english"),()=>n()("settingPageModal.theme"),()=>({active:m().theme==="light"}),()=>n()("settingPageModal.light"),()=>({active:m().theme==="dark"}),()=>n()("settingPageModal.dark"),()=>n()("settingPageModal.deleteAccount")],F),d("click",et,dt),d("click",Q,()=>Ta(aa,Be(m).language="ko",Be(m))),d("click",c,()=>Ta(aa,Be(m).language="en",Be(m))),d("click",nt,()=>Ta(aa,Be(m).theme="light",Be(m))),d("click",K,()=>Ta(aa,Be(m).theme="dark",Be(m))),d("click",Ct,P),d("click",O,fs(dt)),v(B,O)};b(g,B=>{rt()&&B(A)})}v(X,p),Le(),ft()}var Vs=u('<div class="loading-state svelte-1ss8ffn"><!></div>'),Bs=u('<div class="empty-state svelte-1ss8ffn"><!> <p> </p></div>'),Ws=u('<span style="color: var(--primary);">무료</span>'),Ks=u("<button> </button>"),Js=u('<label class="radio-label svelte-1ss8ffn"><input type="radio"/> </label>'),Gs=u('<input class="custom-reason-input svelte-1ss8ffn" type="text" placeholder="Detailed reason..."/>'),Qs=u('<div class="refund-form svelte-1ss8ffn"><div class="reason-select"><p class="reason-label svelte-1ss8ffn"> </p> <div class="radio-group svelte-1ss8ffn"></div> <!></div> <div class="form-actions svelte-1ss8ffn"><button class="cancel-btn svelte-1ss8ffn"> </button> <button class="submit-btn svelte-1ss8ffn"><!></button></div></div>'),Xs=u('<div class="history-item-wrapper svelte-1ss8ffn"><div class="history-item svelte-1ss8ffn"><div class="item-info svelte-1ss8ffn"><div class="item-main svelte-1ss8ffn"><span class="item-name"> </span> <span class="item-amount svelte-1ss8ffn"><!></span></div> <div class="item-sub svelte-1ss8ffn"><span class="item-date"> </span> <span> </span></div></div> <!></div> <!></div>'),Ys=u('<div class="history-list svelte-1ss8ffn"></div>'),Zs=u('<div class="empty-state svelte-1ss8ffn"><!> <p> </p></div>'),tr=u('<div class="history-item-wrapper svelte-1ss8ffn" style="padding: 0.75rem;"><div class="history-item svelte-1ss8ffn"><div class="item-info svelte-1ss8ffn"><div class="item-main svelte-1ss8ffn"><span class="item-name text-sm"> </span> <span> <!></span></div> <div class="item-sub svelte-1ss8ffn"><span class="item-date text-xs opacity-60"> </span></div></div></div></div>'),er=u('<div class="history-list svelte-1ss8ffn"></div>'),ar=u('<div class="modal-backdrop svelte-1ss8ffn"><div class="modal-container svelte-1ss8ffn"><button class="close-button svelte-1ss8ffn"><!></button> <h2 class="modal-title svelte-1ss8ffn"> </h2> <div class="balance-summary svelte-1ss8ffn"><div class="balance-card svelte-1ss8ffn"><span class="balance-label svelte-1ss8ffn"> </span> <div class="balance-value neuron svelte-1ss8ffn"><!> <span> </span></div></div> <div class="balance-card svelte-1ss8ffn"><span class="balance-label svelte-1ss8ffn"> </span> <div class="balance-value svelte-1ss8ffn"><!> <span> </span></div></div></div> <div class="tabs svelte-1ss8ffn"><button> </button> <button> </button></div> <div class="history-list-container svelte-1ss8ffn"><!></div></div></div>');function sr(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft(ke,"$t",G),m=()=>Ft($a,"$st_user",G),rt=[];let N=me(q,"isOpen",8,!1);const dt=oa();let P=$("history"),l=$([]),p=$([]),g=$(!1),A=$({});async function B(){if(!a(g)){i(g,!0);try{i(l,await xs()),a(l).sort((c,E)=>new Date(E.created_at).getTime()-new Date(c.created_at).getTime())}catch(c){console.error("Failed to load payment history:",c)}finally{i(g,!1)}}}async function O(){if(!a(g)){i(g,!0);try{i(p,await qs())}catch(c){console.error("Failed to load credit history:",c)}finally{i(g,!1)}}}function W(){dt("close")}function et(c){c.key==="Escape"&&N()&&W()}function T(c){if(c.status!=="paid")return!1;const E=new Date(c.created_at),H=7*24*60*60*1e3;return Date.now()-E.getTime()<H}let D=$(null),k=$(""),I=$("");function y(c){a(D)===c.id?i(D,null):(i(D,c.id),i(k,""),i(I,""))}async function C(c){if(!a(k)){le.error(n()("paymentHistoryModal.reasons.label"));return}const E=a(k)==="other"?`Other: ${a(I)}`:n()(`paymentHistoryModal.reasons.${a(k)}`);if(!a(A)[c.id]){qe(A,a(A)[c.id]=!0);try{const H=await Re.post("/api/user/payments/refund",{orderId:c.id,reason:E});if(!H.ok){const j=await H.json().catch(()=>({}));throw new Error(j.message||"Failed to submit refund request")}le.success(n()("paymentHistoryModal.refundRequested")),le.success(n()("paymentHistoryModal.refundRequested")),i(l,a(l).map(j=>j.id===c.id?{...j,status:"refund_requested"}:j)),i(D,null)}catch(H){console.error("Refund request failed:",H),le.error(H.message||"Failed to submit refund request.")}finally{qe(A,a(A)[c.id]=!1)}}}function R(c,E,H){return H==="reward"?`${c.split(" ")[0]||"200"} ${n()("paymentHistoryModal.rewardItem")}`:E===1200?n()("itemName.pack_1"):E===5e3?n()("itemName.pack_2"):E===1e4?n()("itemName.pack_3"):c}function S(c){if(c.includes("PortOne"))return n()("creditReason.purchase");if(c.includes("2D Chat Start"))return n()("creditReason.chat_start_2d");if(c.includes("3D Chat Start"))return n()("creditReason.chat_start_3d");if(c.includes("Live2D Chat Start"))return n()("creditReason.chat_start_live2d");const E=c.split(" ")[0];return n()(`creditReason.${E}`)||c}Sa(()=>{window.addEventListener("keydown",et)}),ss(()=>{window.removeEventListener("keydown",et)}),Ee(()=>(ra(N()),a(P)),()=>{N()&&(a(P)==="history"?B():O())}),Ee(()=>(a(P),ra(N())),()=>{a(P)&&N()&&(a(P)==="history"?B():O())}),Ma(),Ae();var Q=sa(),Y=We(Q);{var L=c=>{var E=ar(),H=e(E),j=e(H),it=e(j);w(it,{icon:"ph:x-bold"}),t(j);var at=s(j,2),z=e(at,!0);t(at);var nt=s(at,2),jt=e(nt),zt=e(jt),Vt=e(zt,!0);t(zt);var K=s(zt,2),Lt=e(K);Da(Lt,{size:24,color:"currentColor"});var Tt=s(Lt,2),lt=e(Tt,!0);t(Tt),t(K),t(jt);var bt=s(jt,2),Ct=e(bt),wt=e(Ct,!0);t(Ct);var Jt=s(Ct,2),Bt=e(Jt);w(Bt,{icon:"ph:coins-fill",class:"point-icon"});var Gt=s(Bt,2),be=e(Gt,!0);t(Gt),t(Jt),t(bt),t(nt);var Yt=s(nt,2),xt=e(Yt);let Zt;var te=e(xt,!0);t(xt);var It=s(xt,2);let ee;var ue=e(It,!0);t(It),t(Yt);var fe=s(Yt,2),Ie=e(fe);{var Me=qt=>{var Wt=Vs(),pe=e(Wt);w(pe,{icon:"svg-spinners:ring-resize",width:"32"}),t(Wt),v(qt,Wt)},Se=(qt,Wt)=>{{var pe=ae=>{var ve=sa(),St=We(ve);{var he=kt=>{var ht=Bs(),Rt=e(ht);w(Rt,{icon:"ph:receipt-bold",width:"48",style:"opacity: 0.3;"});var _=s(Rt,2),V=e(_,!0);t(_),t(ht),M(ot=>o(V,ot),[()=>n()("paymentHistoryModal.noHistory")],F),v(kt,ht)},se=kt=>{var ht=Ys();Ke(ht,5,()=>a(l),pa,(Rt,_)=>{var V=Xs(),ot=e(V),$t=e(ot),Mt=e($t),Qt=e(Mt),ge=e(Qt,!0);t(Qt);var _e=s(Qt,2),De=e(_e);{var Ge=gt=>{var pt=fa();M(re=>o(pt,`${re??""}
                                                        ${a(_).currency||"KRW"}`),[()=>a(_).amount.toLocaleString()],F),v(gt,pt)},Ne=gt=>{var pt=Ws();v(gt,pt)};b(De,gt=>{a(_).amount>0?gt(Ge):gt(Ne,!1)})}t(_e),t(Mt);var Oe=s(Mt,2),Qe=e(Oe),ma=e(Qe,!0);t(Qe);var Xe=s(Qe,2),la=e(Xe,!0);t(Xe),t(Oe),t($t);var Oa=s($t,2);{var Ca=gt=>{var pt=Ks();let re;var Ye=e(pt,!0);t(pt),M((ba,r)=>{re=yt(pt,1,"refund-btn svelte-1ss8ffn",null,re,ba),o(Ye,r)},[()=>({active:a(D)===a(_).id}),()=>n()("paymentHistoryModal.refund")],F),d("click",pt,()=>y(a(_))),v(gt,pt)};b(Oa,gt=>{T(a(_))&&a(_).status==="paid"&&gt(Ca)})}t(ot);var Ha=s(ot,2);{var Ra=gt=>{var pt=Qs(),re=e(pt),Ye=e(re),ba=e(Ye,!0);t(Ye);var r=s(Ye,2);Ke(r,4,()=>["simple_change","mistake","error","other"],pa,(st,vt)=>{var Pt=Js(),ut=e(Pt);ia(ut);var J,Ot=s(ut);t(Pt),M(Ht=>{na(ut,"name",`refund_reason_${a(_).id??""}`),J!==(J=vt)&&(ut.value=(ut.__value=vt)??""),o(Ot,` ${Ht??""}`)},[()=>n()(`paymentHistoryModal.reasons.${vt}`)],F),us(rt,[],ut,()=>a(k),Ht=>i(k,Ht)),v(st,Pt)}),t(r);var f=s(r,2);{var x=st=>{var vt=Gs();ia(vt),_a(vt,()=>a(I),Pt=>i(I,Pt)),v(st,vt)};b(f,st=>{a(k)==="other"&&st(x)})}t(re);var h=s(re,2),U=e(h),_t=e(U,!0);t(U);var Dt=s(U,2),ie=e(Dt);{var Nt=st=>{var vt=fa("...");v(st,vt)},Et=st=>{var vt=fa();M(Pt=>o(vt,Pt),[()=>n()("paymentHistoryModal.submit")],F),v(st,vt)};b(ie,st=>{a(A)[a(_).id]?st(Nt):st(Et,!1)})}t(Dt),t(h),t(pt),M((st,vt)=>{o(ba,st),o(_t,vt),Dt.disabled=!a(k)||a(A)[a(_).id]},[()=>n()("paymentHistoryModal.reasons.label"),()=>n()("paymentHistoryModal.cancel")],F),d("click",U,()=>i(D,null)),d("click",Dt,()=>C(a(_))),Je(3,pt,()=>ka),v(gt,pt)};b(Ha,gt=>{a(D)===a(_).id&&gt(Ra)})}t(V),M((gt,pt,re)=>{o(ge,gt),o(ma,pt),yt(Xe,1,`status-badge status-${a(_).status}`,"svelte-1ss8ffn"),o(la,re)},[()=>R(a(_).item_name,a(_).amount,a(_).variant_id),()=>new Date(a(_).created_at).toLocaleDateString(),()=>n()(`paymentHistoryModal.status.${a(_).status}`)||a(_).status],F),v(Rt,V)}),t(ht),v(kt,ht)};b(St,kt=>{a(l).length===0?kt(he):kt(se,!1)})}v(ae,ve)},Pe=ae=>{var ve=sa(),St=We(ve);{var he=kt=>{var ht=Zs(),Rt=e(ht);w(Rt,{icon:"ph:coin-vertical",width:"48",style:"opacity: 0.3;"});var _=s(Rt,2),V=e(_,!0);t(_),t(ht),M(ot=>o(V,ot),[()=>n()("paymentHistoryModal.noUsageHistory")],F),v(kt,ht)},se=kt=>{var ht=er();Ke(ht,5,()=>a(p),pa,(Rt,_)=>{var V=tr(),ot=e(V),$t=e(ot),Mt=e($t),Qt=e(Mt),ge=e(Qt,!0);t(Qt);var _e=s(Qt,2),De=e(_e),Ge=s(De);Da(Ge,{size:14,color:"currentColor"}),t(_e),t(Mt);var Ne=s(Mt,2),Oe=e(Ne),Qe=e(Oe,!0);t(Oe),t(Ne),t($t),t(ot),t(V),M((ma,Xe,la)=>{o(ge,ma),yt(_e,1,`item-amount ${a(_).amount>0?"text-green-500":"text-red-400"}`,"svelte-1ss8ffn"),o(De,`${a(_).amount>0?"+":""}${Xe??""} `),o(Qe,la)},[()=>S(a(_).reason),()=>a(_).amount.toLocaleString(),()=>new Date(a(_).created_at).toLocaleString()],F),v(Rt,V)}),t(ht),v(kt,ht)};b(St,kt=>{a(p).length===0?kt(he):kt(se,!1)})}v(ae,ve)};b(qt,ae=>{a(P)==="history"?ae(pe):ae(Pe,!1)},Wt)}};b(Ie,qt=>{a(g)?qt(Me):qt(Se,!1)})}t(fe),t(H),t(E),M((qt,Wt,pe,Pe,ae,ve,St,he,se)=>{o(z,qt),o(Vt,Wt),o(lt,pe),o(wt,Pe),o(be,ae),Zt=yt(xt,1,"tab-btn svelte-1ss8ffn",null,Zt,ve),o(te,St),ee=yt(It,1,"tab-btn svelte-1ss8ffn",null,ee,he),o(ue,se)},[()=>n()("paymentHistoryModal.title"),()=>n()("settingPage.credits"),()=>m()?.credits?.toLocaleString()||"0",()=>n()("settingPage.creatorPoints"),()=>m()?.creator_points?.toLocaleString()||"0",()=>({active:a(P)==="history"}),()=>n()("paymentHistoryModal.tabs.chargeHistory"),()=>({active:a(P)==="usage"}),()=>n()("paymentHistoryModal.tabs.usageHistory")],F),d("click",j,W),d("click",xt,()=>i(P,"history")),d("click",It,()=>i(P,"usage")),d("click",H,Pa(function(qt){Na.call(this,q,qt)})),d("click",E,W),Je(3,E,()=>ka),v(c,E)};b(Y,c=>{N()&&c(L)})}v(X,Q),Le(),ft()}var rr=u('<h4 class="text-sm font-semibold mb-0.5" style="color: var(--foreground);"> </h4>'),ir=u('<span class="font-semibold text-foreground"> </span>'),nr=u('<div class="w-2 h-2 rounded-full bg-blue-500 mt-2 shrink-0"></div>'),or=u('<div class="flex items-start gap-3 p-4 border-b cursor-pointer transition-colors"><div><!></div> <div class="flex-1 min-w-0"><!> <p class="text-sm break-words leading-relaxed" style="color: var(--muted-foreground);"><!> </p> <span class="text-xs mt-1.5 block" style="color: var(--muted-foreground); opacity: 0.7;"> </span></div> <!> <button class="p-1 text-gray-400 hover:text-red-500 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors ml-2"><!></button></div>');function lr(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft(ke,"$t",G);let m=me(q,"notification",8);const rt=oa();function N(L,c){const E=new Date(L),j=Math.floor((new Date().getTime()-E.getTime())/1e3);if(j<60)return c("time.now");const it=Math.floor(j/60);if(it<60)return c("time.minutesAgo").replace("{count}",it);const at=Math.floor(it/60);if(at<24)return c("time.hoursAgo").replace("{count}",at);const z=Math.floor(at/24);return z<7?c("time.daysAgo").replace("{count}",z):E.toLocaleDateString()}function dt(){m().isRead||$e.markAsRead(m().id,m().title?"announcement":"notification"),rt("click",m())}function P(L){switch(L){case"comment":return"lucide:message-circle";case"like":return"lucide:heart";case"follow":return"lucide:user-plus";case"auction_bid":return"lucide:gavel";case"auction_win":return"lucide:trophy";case"system":return"lucide:info";case"info":return"lucide:info";case"warning":return"lucide:alert-triangle";case"maintenance":return"lucide:wrench";case"update":return"lucide:sparkles";default:return"lucide:bell"}}function l(L){switch(L){case"like":return"text-red-500";case"auction_win":return"text-yellow-500";case"warning":return"text-orange-500";case"maintenance":return"text-blue-500";default:return"text-gray-500"}}Ae();var p=or(),g=e(p),A=e(g);const B=F(()=>P(m().type));w(A,{get icon(){return a(B)},width:"20",height:"20"}),t(g);var O=s(g,2),W=e(O);{var et=L=>{var c=rr(),E=e(c,!0);t(c),M(()=>o(E,m().title)),v(L,c)};b(W,L=>{m().title&&L(et)})}var T=s(W,2),D=e(T);{var k=L=>{var c=ir(),E=e(c,!0);t(c),M(()=>o(E,m().actorName)),v(L,c)};b(D,L=>{m().actorName&&L(k)})}var I=s(D);t(T);var y=s(T,2),C=e(y,!0);t(y),t(O);var R=s(O,2);{var S=L=>{var c=nr();v(L,c)};b(R,L=>{m().isRead||L(S)})}var Q=s(R,2),Y=e(Q);w(Y,{icon:"lucide:trash-2",class:"w-4 h-4"}),t(Q),t(p),M((L,c,E)=>{ds(p,`border-color: var(--border); ${m().isRead?"opacity: 0.6;":"background-color: var(--muted);"}`),yt(g,1,`mt-1 ${L??""}`),o(I,` ${m().content??""}`),o(C,c),na(Q,"title",E)},[()=>l(m().type),()=>N(m().createdAt,n()),()=>n()("common.delete")],F),d("click",Q,Pa(()=>$e.deleteNotification(m().id))),d("click",p,dt),v(X,p),Le(),ft()}var vr=u('<div class="flex items-center justify-center p-8 text-gray-400"><!></div>'),cr=u('<div class="flex flex-col items-center justify-center p-8 text-gray-400 text-center"><!> <p class="text-sm"> </p></div>'),dr=u('<div class="p-4 text-center"><button class="text-sm text-blue-500 hover:text-blue-600 font-medium disabled:opacity-50"><!></button></div>'),ur=u('<div class="flex-1 overflow-y-auto"><!> <!></div>'),fr=u('<div class="flex flex-col h-full"><!></div>');function pr(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft(P,"$loading",G),m=()=>Ft($e,"$notificationStore",G),rt=()=>Ft(l,"$initialized",G),N=()=>Ft(ke,"$t",G);me(q,"compact",8,!1);const{subscribe:dt,loading:P,initialized:l}=$e;let p=0;const g=20;function A(){p+=g,$e.fetchNotifications(g,p)}Ae();var B=fr(),O=e(B);{var W=T=>{var D=vr(),k=e(D);w(k,{icon:"lucide:loader-2",class:"animate-spin w-6 h-6"}),t(D),v(T,D)},et=(T,D)=>{{var k=y=>{var C=cr(),R=e(C);w(R,{icon:"lucide:bell-off",class:"w-12 h-12 mb-3 opacity-50"});var S=s(R,2),Q=e(S,!0);t(S),t(C),M(Y=>o(Q,Y),[()=>N()("notifications.empty")],F),v(y,C)},I=y=>{var C=ur(),R=e(C);Ke(R,1,m,Y=>Y.id,(Y,L)=>{lr(Y,{get notification(){return a(L)}})});var S=s(R,2);{var Q=Y=>{var L=dr(),c=e(L),E=e(c);{var H=it=>{var at=fa();M(z=>o(at,z),[()=>N()("notifications.loading")],F),v(it,at)},j=it=>{var at=fa();M(z=>o(at,z),[()=>N()("notifications.loadMore")],F),v(it,at)};b(E,it=>{n()?it(H):it(j,!1)})}t(c),t(L),M(()=>c.disabled=n()),d("click",c,A),v(Y,L)};b(S,Y=>{m().length>=g&&Y(Q)})}t(C),v(y,C)};b(T,y=>{m().length===0&&rt()?y(k):y(I,!1)},D)}};b(O,T=>{n()&&m().length===0?T(W):T(et,!1)})}t(B),v(X,B),Le(),ft()}var _r=u('<div class="fixed inset-0 bg-black/50 z-50 backdrop-blur-sm"></div> <div class="fixed inset-y-0 right-0 w-full max-w-md shadow-2xl z-50 flex flex-col border-l" style="background-color: var(--card); border-color: var(--border);"><div class="grid grid-cols-5 items-center p-4 border-b" style="border-color: var(--border);"><div class="col-span-1 flex justify-start"></div> <h2 class="col-span-3 text-lg font-semibold flex items-center justify-center gap-2 whitespace-nowrap" style="color: var(--foreground);"><!> <span class="truncate"> </span></h2> <div class="col-span-1 flex justify-end"><button class="p-2 text-gray-500 hover:text-red-500 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"><!></button></div></div> <div class="flex-1 overflow-y-auto drawer-content svelte-gnd4bg"><!></div></div>',1);function mr(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft(ke,"$t",G);let m=me(q,"isOpen",8,!1);const rt=oa();function N(){rt("close")}Ee(()=>(ra(m()),$e),()=>{m()&&$e.fetchNotifications()}),Ma(),Ae();var dt=sa(),P=We(dt);{var l=p=>{var g=_r(),A=We(g),B=s(A,2),O=e(B),W=s(e(O),2),et=e(W);w(et,{icon:"lucide:bell",class:"w-5 h-5 flex-shrink-0"});var T=s(et,2),D=e(T,!0);t(T),t(W);var k=s(W,2),I=e(k),y=e(I);w(y,{icon:"lucide:x",class:"w-5 h-5"}),t(I),t(k),t(O);var C=s(O,2),R=e(C);pr(R,{}),t(C),t(B),M(S=>o(D,S),[()=>n()("notifications.title")],F),Je(3,A,()=>ka,()=>({duration:200})),d("click",A,N),d("click",I,N),Je(3,B,()=>rs,()=>({x:300,duration:300})),v(p,g)};b(P,p=>{m()&&p(l)})}v(X,dt),Le(),ft()}var br=u('<div class="loading svelte-crqcm2">Loading...</div>'),hr=u('<div class="error svelte-crqcm2"> </div>'),gr=u('<div class="empty svelte-crqcm2">No users found.</div>'),yr=u("<button> </button>"),wr=u('<div class="user-item svelte-crqcm2"><div class="user-info svelte-crqcm2"><img class="avatar svelte-crqcm2"/> <span class="name svelte-crqcm2"> </span></div> <!></div>'),xr=u('<div class="user-list svelte-crqcm2"></div>'),qr=u('<div class="modal-backdrop svelte-crqcm2"><div class="modal-content svelte-crqcm2"><div class="modal-header svelte-crqcm2"><div class="tabs svelte-crqcm2"><button>Followers</button> <button>Following</button></div> <button class="close-btn svelte-crqcm2"><!></button></div> <div class="modal-body svelte-crqcm2"><!></div></div></div>');function kr(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft($a,"$st_user",G);let m=me(q,"isOpen",12,!1),rt=me(q,"initialTab",8,"followers"),N=me(q,"userId",8);const dt=oa();let P=$(rt()),l=$([]),p=$(!1),g=$(null),A=$({});async function B(){i(p,!0),i(g,null),i(l,[]);try{let k=[];if(a(P)==="followers"?k=await is(N()):k=await Ka(N()),k.length>0){const I=k.map(async C=>{try{const R=await Re.get2(`/api/creator/info?id=${C}`);if(R.ok){const S=await R.json();return{id:C,name:S.creator.name,portrait_url:S.creator.portrait_url}}}catch(R){console.error(`Failed to load user ${C}`,R)}return null}),y=await Promise.all(I);if(i(l,y.filter(C=>C!==null)),n())if(N()===n().id&&a(P)==="following")a(l).forEach(C=>qe(A,a(A)[C.id]=!0));else{const C=await Ka(n().id),R=new Set(C);a(l).forEach(S=>{qe(A,a(A)[S.id]=R.has(S.id))})}}}catch(k){i(g,k.message)}finally{i(p,!1)}}async function O(k){if(!n())return;const I=a(A)[k];try{let y=!1;I?y=await ks(k):y=await $s(k),y&&qe(A,a(A)[k]=!I)}catch(y){console.error("Failed to toggle follow",y)}}function W(){m(!1),dt("close")}Ee(()=>(ra(m()),ra(rt())),()=>{m()&&(i(P,rt()),B())}),Ee(()=>(a(P),ra(m())),()=>{a(P)&&m()&&B()}),Ma(),Ae();var et=sa(),T=We(et);{var D=k=>{var I=qr(),y=e(I),C=e(y),R=e(C),S=e(R);let Q;var Y=s(S,2);let L;t(R);var c=s(R,2),E=e(c);w(E,{icon:"ri:close-line",width:"24",height:"24"}),t(c),t(C);var H=s(C,2),j=e(H);{var it=z=>{var nt=br();v(z,nt)},at=(z,nt)=>{{var jt=Vt=>{var K=hr(),Lt=e(K,!0);t(K),M(()=>o(Lt,a(g))),v(Vt,K)},zt=(Vt,K)=>{{var Lt=lt=>{var bt=gr();v(lt,bt)},Tt=lt=>{var bt=xr();Ke(bt,5,()=>a(l),Ct=>Ct.id,(Ct,wt)=>{var Jt=wr(),Bt=e(Jt),Gt=e(Bt),be=s(Gt,2),Yt=e(be,!0);t(be),t(Bt);var xt=s(Bt,2);{var Zt=te=>{var It=yr();let ee;var ue=e(It,!0);t(It),M(fe=>{ee=yt(It,1,"follow-btn svelte-crqcm2",null,ee,fe),o(ue,a(A)[a(wt).id]?"Unfollow":"Follow")},[()=>({following:a(A)[a(wt).id]})],F),d("click",It,()=>O(a(wt).id)),v(te,It)};b(xt,te=>{n()&&n().id!==a(wt).id&&te(Zt)})}t(Jt),M(te=>{na(Gt,"src",te),na(Gt,"alt",a(wt).name),o(Yt,a(wt).name)},[()=>a(wt).portrait_url||`https://placehold.co/40x40/1a1a1a/ffffff?text=${a(wt).name.charAt(0)}`],F),d("click",Bt,()=>{xe(`/creator?c=${a(wt).id}`),W()}),v(Ct,Jt)}),t(bt),v(lt,bt)};b(Vt,lt=>{a(l).length===0?lt(Lt):lt(Tt,!1)},K)}};b(z,Vt=>{a(g)?Vt(jt):Vt(zt,!1)},nt)}};b(j,z=>{a(p)?z(it):z(at,!1)})}t(H),t(y),t(I),M((z,nt)=>{Q=yt(S,1,"svelte-crqcm2",null,Q,z),L=yt(Y,1,"svelte-crqcm2",null,L,nt)},[()=>({active:a(P)==="followers"}),()=>({active:a(P)==="following"})],F),d("click",S,()=>i(P,"followers")),d("click",Y,()=>i(P,"following")),d("click",c,W),d("click",y,Pa(function(z){Na.call(this,q,z)})),Je(3,y,()=>bs,()=>({duration:200,start:.95})),d("click",I,W),Je(3,I,()=>ka,()=>({duration:200})),v(k,I)};b(T,k=>{m()&&k(D)})}v(X,et),Le(),ft()}var $r=u('<span class="notification-badge svelte-1r6v9q6"></span>'),Mr=u('<button class="icon-btn svelte-1r6v9q6" aria-label="Settings"><!></button>'),Pr=u('<div class="error-banner svelte-1r6v9q6"><!> <span> </span></div>'),Cr=u('<button class="primary-btn svelte-1r6v9q6"><!> <span class="btn-label svelte-1r6v9q6"> </span></button>'),Rr=u('<button class="avatar-edit-btn svelte-1r6v9q6"><!></button>'),Er=u('<div class="avatar-wrapper svelte-1r6v9q6"><img alt="Profile" class="avatar-image svelte-1r6v9q6"/> <!></div>'),Ar=u('<button class="avatar-edit-btn svelte-1r6v9q6"><!></button>'),Fr=u('<div class="avatar-wrapper svelte-1r6v9q6"><div class="avatar-placeholder svelte-1r6v9q6"> </div> <!></div>'),Lr=u('<span title="Verified User" class="verified-badge-wrapper svelte-1r6v9q6"><!></span>'),Tr=u('<button class="verification-btn-small svelte-1r6v9q6" title="본인인증 (성인인증)"><!> <span> </span></button>'),Ir=u('<div class="user-name-group svelte-1r6v9q6"><h2 class="user-display-name svelte-1r6v9q6"> </h2> <span class="user-handle svelte-1r6v9q6"> </span> <button class="edit-icon-btn svelte-1r6v9q6" aria-label="Edit Profile"><!></button> <!></div>'),Sr=u('<div class="edit-inputs svelte-1r6v9q6"><input type="text" class="input-field svelte-1r6v9q6" placeholder="Display Name"/> <input type="text" class="input-field svelte-1r6v9q6" placeholder="Username"/></div>'),Dr=u('<button class="install-banner-btn svelte-1r6v9q6"><!> <span> </span></button>'),Nr=u('<div class="enhanced-actions svelte-1r6v9q6"><div class="bottom-utility-row"><button class="logout-link-btn svelte-1r6v9q6"><!> <span> </span></button></div> <!></div>'),Or=u('<div class="edit-actions svelte-1r6v9q6"><button class="cancel-btn svelte-1r6v9q6"><!></button> <button class="save-btn svelte-1r6v9q6"><!></button></div>'),Hr=u('<div class="profile-tab-content svelte-1r6v9q6"><div class="profile-card svelte-1r6v9q6"><div class="profile-main svelte-1r6v9q6"><div class="profile-avatar-section svelte-1r6v9q6"><!> <input type="file" id="profile-upload" accept="image/*" style="display: none;"/></div> <div class="profile-info-section svelte-1r6v9q6"><!> <div class="follow-stats-inline svelte-1r6v9q6"><button class="stat-btn svelte-1r6v9q6"><span class="stat-num svelte-1r6v9q6"> </span> <span class="stat-label svelte-1r6v9q6">Followers</span></button> <span class="stat-divider svelte-1r6v9q6">·</span> <button class="stat-btn svelte-1r6v9q6"><span class="stat-num svelte-1r6v9q6"> </span> <span class="stat-label svelte-1r6v9q6">Following</span></button></div></div> <div class="profile-actions-section svelte-1r6v9q6"><!></div></div> <div class="stats-grid svelte-1r6v9q6"><div class="stat-card svelte-1r6v9q6"><div class="stat-header svelte-1r6v9q6"><span class="stat-title svelte-1r6v9q6"> </span> <button class="history-request-btn svelte-1r6v9q6"><!> </button></div> <div class="stat-value-container svelte-1r6v9q6"><div class="stat-value-row svelte-1r6v9q6"><!> <span class="stat-value-large svelte-1r6v9q6"> </span></div> <button class="primary-btn compact svelte-1r6v9q6"><!> </button></div></div> <div class="stat-card svelte-1r6v9q6"><div class="stat-header svelte-1r6v9q6"><span class="stat-title svelte-1r6v9q6"> <button class="info-icon-btn svelte-1r6v9q6"><!></button></span></div> <div class="stat-value-container svelte-1r6v9q6"><div class="stat-value-row svelte-1r6v9q6"><span class="stat-value-large svelte-1r6v9q6"> </span> <span class="stat-unit svelte-1r6v9q6">Points</span></div> <button class="primary-btn compact svelte-1r6v9q6"><!> </button></div></div></div></div></div>'),Ur=u('<div class="loading-state svelte-1r6v9q6"><!> <span>Loading...</span></div>'),jr=u('<span class="live-badge svelte-1r6v9q6">LIVE</span>'),zr=u('<div class="persona-card-new svelte-1r6v9q6"><button class="persona-preview svelte-1r6v9q6"><!> <div class="hover-overlay svelte-1r6v9q6"><!></div> <!></button> <div class="persona-info svelte-1r6v9q6"><h3 class="persona-name svelte-1r6v9q6"> </h3> <p class="persona-type-text svelte-1r6v9q6"> </p></div> <div class="persona-actions svelte-1r6v9q6"><button class="action-btn svelte-1r6v9q6" aria-label="Edit"><!></button> <button><!></button></div></div>'),Vr=u('<div class="empty-state svelte-1r6v9q6"><!> <p>No personas yet</p></div>'),Br=u('<div class="content-grid svelte-1r6v9q6"><!> <!></div>'),Wr=u('<div class="empty-state svelte-1r6v9q6"><!> <p> </p></div>'),Kr=u('<div class="content-grid svelte-1r6v9q6"><!> <!></div>'),Jr=u('<div class="empty-state svelte-1r6v9q6"><!> <p> </p></div>'),Gr=u('<div class="content-grid svelte-1r6v9q6"><!> <!></div>'),Qr=u('<div class="modal-overlay svelte-1r6v9q6" role="button" tabindex="0"><div class="modal-box svelte-1r6v9q6"><h2 class="modal-title svelte-1r6v9q6"> </h2> <p class="modal-desc svelte-1r6v9q6"> </p> <button class="primary-btn full-width svelte-1r6v9q6"> </button></div></div>'),Xr=u('<div class="page-container svelte-1r6v9q6"><header class="page-header svelte-1r6v9q6"><h1 class="page-title svelte-1r6v9q6"> </h1> <div class="header-actions svelte-1r6v9q6"><button class="icon-btn svelte-1r6v9q6" aria-label="Notifications"><!> <!></button> <!></div></header> <!> <div class="content-section svelte-1r6v9q6"><div class="tabs-header svelte-1r6v9q6"><div class="tabs-nav svelte-1r6v9q6"><button><!> <span class="tab-label svelte-1r6v9q6"> </span></button> <button><!> <span class="tab-label svelte-1r6v9q6"> </span></button> <button><!> <span class="tab-label svelte-1r6v9q6"> </span></button> <button><!> <span class="tab-label svelte-1r6v9q6"> </span></button></div> <!></div> <div class="content-area svelte-1r6v9q6"><!></div></div> <!> <!> <!> <!> <!> <!> <!></div>');function Ii(X,q){Fe(q,!1);const[G,ft]=Te(),n=()=>Ft(ke,"$t",G),m=()=>Ft(it,"$unreadCount",G),rt=()=>Ft(Ia,"$locale",G),N=()=>Ft($a,"$st_user",G),dt=$(),P="/storage/v1/object/public/personaxi-assets/";let l=$({id:"",name:"",credits:0,gender:"",plan:"",profile:"",email:"",state:"",data:{nickname:"",language:"",lastLoginAt:"",createdAt:"",hasReceivedFirstCreationReward:!1,lastLoginIP:""}}),p=$([]),g=$(""),A=$([]),B=$(!1),O=$(!1);async function W(r){const f=r.detail.amount;try{await Re.convertPoints(f);const x=xa(ke);le.success(x("pointConvertModal.success"));const h=await qa();h&&i(l,h)}catch(x){const h=xa(ke);le.error(h("pointConvertModal.fail",{values:{error:x.message}}))}}let et=$(null),T=$(!1),D=null,k=$(!1);function I(){confirm("정말 로그아웃 하시겠습니까?")&&_s()}let y=$(!1);async function C(){a(y)||(i(y,!0),await Fs({onSuccess:async()=>{const r=await qa();r&&(i(l,r),$a.set(a(l))),i(y,!1)},onError:()=>{i(y,!1)}}))}Sa(async()=>{if(typeof window<"u"){const r=window.matchMedia("(display-mode: standalone)").matches,f=window.navigator.standalone===!0;if(i(k,r||f),!document.getElementById("portone-v2-sdk")){const x=document.createElement("script");x.id="portone-v2-sdk",x.src="https://cdn.portone.io/v2/browser-sdk.js",x.defer=!0,document.body.appendChild(x)}}try{const r=await qa();r?(i(l,r),$e.init(a(l).id),(!a(l).data||a(l).data.language==="")&&(qe(l,a(l).data={nickname:a(l).name,language:xa(Ia)||"",lastLoginAt:"",createdAt:"",hasReceivedFirstCreationReward:!1,lastLoginIP:""}),aa.update(h=>(h.language=a(l).data.language||"en",{...h})))):(i(g,"Failed to load user"),xe("/login"));const f=await Re.get("/api/persona/user");f.ok?i(p,await f.json()):i(g,"Failed to load personas");const x=await as();i(A,x.map(h=>h))}catch(r){i(g,"Error: "+r)}});function R(r){return a(A).includes(r)}async function S(r){const f=r.visibility==="public"?"private":"public";try{const x=await Re.post("/api/persona/visibility",{personaId:r.id,visibility:f});if(x.ok){const h=a(p).map(U=>U.id===r.id?{...U,visibility:f}:U);i(p,h),i(g,"")}else{const h=await x.text();i(g,`Failed to update visibility: ${h}`)}}catch(x){i(g,"Error updating visibility: "+x)}}function Q(){D=JSON.parse(JSON.stringify(a(l))),i(T,!0)}function Y(){D&&i(l,D),i(T,!1)}async function L(r){const f=r.target;if(!f.files||f.files.length===0)return;const x=f.files[0];try{const h=a(l).profile!==D?.profile,U=a(l).profile&&!a(l).profile.startsWith("blob:")&&h?a(l).profile:void 0,_t=await hs("user_profile",U),{signedURL:Dt,fileName:ie}=await _t.json();await gs(Dt,x,Nt=>{console.log(`Upload progress: ${Nt}%`)}),qe(l,a(l).profile=`${P}${ie}`)}catch(h){console.error("Failed to upload profile image:",h),i(g,"Failed to upload profile image")}}async function c(){const r={name:a(l).name,nickname:a(l).data.nickname||"",language:xa(Ia)||"en",profile:a(l).profile};try{const f=await Re.post("/api/user/edit",r);if(f.ok)i(T,!1),i(g,"");else{const x=await f.text();i(g,`Failed to update user settings: ${x}`)}}catch(f){i(g,"Error updating settings: "+f)}}let E=$(!1),H=$(!1),j=$(!1);const{unreadCount:it}=$e;let at=$(!1),z=$(!1),nt=$("followers"),jt=$(0),zt=$(0);Sa(async()=>{try{const r=await qa();r?(i(l,r),$e.init(a(l).id),is(a(l).id).then(h=>i(jt,h.length)),Ka(a(l).id).then(h=>i(zt,h.length)),(!a(l).data||a(l).data.language==="")&&(qe(l,a(l).data={nickname:a(l).name,language:xa(Ia)||"",lastLoginAt:"",createdAt:"",hasReceivedFirstCreationReward:!1,lastLoginIP:""}),aa.update(h=>(h.language=a(l).data.language||"en",{...h})))):(i(g,"Failed to load user"),xe("/login"));const f=await Re.get("/api/persona/user");f.ok?i(p,await f.json()):i(g,"Failed to load personas");const x=await as();i(A,x.map(h=>h))}catch(r){i(g,"Error: "+r)}});function Vt(r){i(nt,r),i(at,!0)}let K=$("profile"),Lt=$([]),Tt=$([]),lt=$(!1);async function bt(r){i(K,r),r==="liked"&&a(Lt).length===0?(i(lt,!0),i(Lt,await Es()),i(lt,!1)):r==="following"&&a(Tt).length===0&&(i(lt,!0),i(Tt,await As()),i(lt,!1))}function Ct(r){xe(`/profile?c=${r.id}`)}function wt(r){let f="gemini-flash-lite";ys.update(x=>{const h=x.find(U=>U.id===r.id);return h&&h.llmType&&(f=h.llmType),x}),(r.personaType==="3D"||r.personaType==="2.5D")&&(f="gemini-flash-lite"),r.personaType==="2D"||r.personaType==="2d"?xe(`/2d?c=${r.id}&llmType=${f}`):r.personaType==="3D"?xe(`/character?c=${r.id}&llmType=${f}`):r.personaType==="2.5D"&&xe(`/live2d?c=${r.id}&llmType=${f}`)}Ee(()=>a(A),()=>{i(dt,a(A))}),Ma(),Ae();var Jt=Xr(),Bt=e(Jt),Gt=e(Bt),be=e(Gt,!0);t(Gt);var Yt=s(Gt,2),xt=e(Yt),Zt=e(xt);w(Zt,{icon:"lucide:bell",width:"24",height:"24"});var te=s(Zt,2);{var It=r=>{var f=$r();v(r,f)};b(te,r=>{m()>0&&r(It)})}t(xt);var ee=s(xt,2);{var ue=r=>{var f=Mr(),x=e(f);w(x,{icon:"ph:gear-six-bold",width:"24",height:"24"}),t(f),d("click",f,()=>i(E,!0)),v(r,f)};b(ee,r=>{rt()&&r(ue)})}t(Yt),t(Bt);var fe=s(Bt,2);{var Ie=r=>{var f=Pr(),x=e(f);w(x,{icon:"ph:warning-circle-bold",width:"20",height:"20"});var h=s(x,2),U=e(h,!0);t(h),t(f),M(()=>o(U,a(g))),v(r,f)};b(fe,r=>{a(g)&&r(Ie)})}var Me=s(fe,2),Se=e(Me),qt=e(Se),Wt=e(qt);let pe;var Pe=e(Wt);w(Pe,{icon:"ph:user-bold",width:"20",height:"20"});var ae=s(Pe,2),ve=e(ae,!0);t(ae),t(Wt);var St=s(Wt,2);let he;var se=e(St);w(se,{icon:"ph:cards-bold",width:"20",height:"20"});var kt=s(se,2),ht=e(kt,!0);t(kt),t(St);var Rt=s(St,2);let _;var V=e(Rt);w(V,{icon:"ph:heart-bold",width:"20",height:"20"});var ot=s(V,2),$t=e(ot,!0);t(ot),t(Rt);var Mt=s(Rt,2);let Qt;var ge=e(Mt);w(ge,{icon:"ph:users-bold",width:"20",height:"20"});var _e=s(ge,2),De=e(_e,!0);t(_e),t(Mt),t(qt);var Ge=s(qt,2);{var Ne=r=>{var f=Cr(),x=e(f);w(x,{icon:"ph:plus-bold",width:"20",height:"20"});var h=s(x,2),U=e(h,!0);t(h),t(f),M(_t=>o(U,_t),[()=>n()("settingPage.newPersona")],F),d("click",f,()=>xe("/edit3")),v(r,f)};b(Ge,r=>{a(K)==="created"&&r(Ne)})}t(Se);var Oe=s(Se,2),Qe=e(Oe);{var ma=r=>{var f=Hr(),x=e(f),h=e(x),U=e(h),_t=e(U);{var Dt=ct=>{var Z=Er(),tt=e(Z),Ut=s(tt,2);{var mt=Xt=>{var At=Rr(),we=e(At);w(we,{icon:"ph:camera-plus-bold",width:"20",height:"20"}),t(At),d("click",At,()=>document.getElementById("profile-upload")?.click()),v(Xt,At)};b(Ut,Xt=>{a(T)&&Xt(mt)})}t(Z),M(()=>na(tt,"src",a(l).profile)),v(ct,Z)},ie=ct=>{var Z=Fr(),tt=e(Z),Ut=e(tt,!0);t(tt);var mt=s(tt,2);{var Xt=At=>{var we=Ar(),wa=e(we);w(wa,{icon:"ph:camera-plus-bold",width:"20",height:"20"}),t(we),d("click",we,()=>document.getElementById("profile-upload")?.click()),v(At,we)};b(mt,At=>{a(T)&&At(Xt)})}t(Z),M(At=>o(Ut,At),[()=>a(l).name.charAt(0).toUpperCase()],F),v(ct,Z)};b(_t,ct=>{a(l).profile?ct(Dt):ct(ie,!1)})}var Nt=s(_t,2);t(U);var Et=s(U,2),st=e(Et);{var vt=ct=>{var Z=Ir(),tt=e(Z),Ut=e(tt,!0);t(tt);var mt=s(tt,2),Xt=e(mt);t(mt);var At=s(mt,2),we=e(At);w(we,{icon:"ri:edit-line",width:"18",height:"18"}),t(At);var wa=s(At,2);{var ea=Ce=>{var de=Lr(),da=e(de);w(da,{icon:"material-symbols:verified-rounded",class:"verified-badge",width:"20",height:"20",color:"#3b82f6"}),t(de),v(Ce,de)},ca=Ce=>{var de=Tr(),da=e(de);w(da,{icon:"ph:shield-check-bold",width:"14"});var La=s(da,2),cs=e(La,!0);t(La),t(de),M(()=>{de.disabled=a(y),o(cs,a(y)?"인증 중...":"인증하기")}),d("click",de,C),v(Ce,de)};b(wa,Ce=>{a(l).data.isVerified?Ce(ea):Ce(ca,!1)})}t(Z),M(()=>{o(Ut,a(l).data.nickname||a(l).name),o(Xt,`@${a(l).name??""}`)}),d("click",At,Q),v(ct,Z)},Pt=ct=>{var Z=Sr(),tt=e(Z);ia(tt);var Ut=s(tt,2);ia(Ut),t(Z),_a(tt,()=>a(l).data.nickname,mt=>qe(l,a(l).data.nickname=mt)),_a(Ut,()=>a(l).name,mt=>qe(l,a(l).name=mt)),v(ct,Z)};b(st,ct=>{a(T)?ct(Pt,!1):ct(vt)})}var ut=s(st,2),J=e(ut),Ot=e(J),Ht=e(Ot,!0);t(Ot),ua(2),t(J);var Kt=s(J,4),ne=e(Kt),ye=e(ne,!0);t(ne),ua(2),t(Kt),t(ut),t(Et);var oe=s(Et,2),ce=e(oe);{var He=ct=>{var Z=Nr(),tt=e(Z),Ut=e(tt),mt=e(Ut);w(mt,{icon:"tabler:logout",width:"18"});var Xt=s(mt,2),At=e(Xt,!0);t(Xt),t(Ut),t(tt);var we=s(tt,2);{var wa=ea=>{var ca=Dr(),Ce=e(ca);w(Ce,{icon:"material-symbols:download-rounded",width:"20"});var de=s(Ce,2),da=e(de,!0);t(de),t(ca),M(La=>o(da,La),[()=>n()("settingPage.installApp")],F),d("click",ca,()=>xe("/install")),v(ea,ca)};b(we,ea=>{a(k)||ea(wa)})}t(Z),M(ea=>o(At,ea),[()=>n()("settingPage.logout")],F),d("click",Ut,I),v(ct,Z)},Ue=ct=>{var Z=Or(),tt=e(Z),Ut=e(tt);w(Ut,{icon:"ri:close-line",width:"20",height:"20"}),t(tt);var mt=s(tt,2),Xt=e(mt);w(Xt,{icon:"ri:check-line",width:"20",height:"20"}),t(mt),t(Z),d("click",tt,Y),d("click",mt,c),v(ct,Z)};b(ce,ct=>{a(T)?ct(Ue,!1):ct(He)})}t(oe),t(h);var je=s(h,2),Ze=e(je),va=e(Ze),ha=e(va),Ea=e(ha,!0);t(ha);var ze=s(ha,2),Aa=e(ze);w(Aa,{icon:"ph:receipt-bold",width:"14",height:"14"});var ta=s(Aa);t(ze),t(va);var ga=s(va,2),ya=e(ga),Fa=e(ya);Da(Fa,{size:28,color:"#a0a0a0"});var Ve=s(Fa,2),Ua=e(Ve,!0);t(Ve),t(ya);var ja=s(ya,2),Ja=e(ja);w(Ja,{icon:"ph:plus-bold",width:"16",height:"16"});var ns=s(Ja);t(ja),t(ga),t(Ze);var Ga=s(Ze,2),za=e(Ga),Qa=e(za),Xa=e(Qa),Va=s(Xa),os=e(Va);w(os,{icon:"ph:info-bold",width:"14",height:"14"}),t(Va),t(Qa),t(za);var Ya=s(za,2),Ba=e(Ya),Za=e(Ba),ls=e(Za,!0);t(Za),ua(2),t(Ba);var Wa=s(Ba,2),ts=e(Wa);w(ts,{icon:"ph:arrows-left-right-bold",width:"16",height:"16"});var vs=s(ts);t(Wa),t(Ya),t(Ga),t(je),t(x),t(f),M((ct,Z,tt,Ut,mt,Xt)=>{o(Ht,a(jt)),o(ye,a(zt)),o(Ea,ct),o(ta,` ${Z??""}`),o(Ua,N()?.credits||a(l).credits),o(ns,` ${tt??""}`),o(Xa,`${Ut??""} `),o(ls,mt),o(vs,` ${Xt??""}`)},[()=>n()("settingPage.credits"),()=>n()("paymentHistoryModal.title"),()=>n()("settingPage.charge"),()=>n()("settingPage.creatorPoints"),()=>(a(l).creator_points||0).toFixed(2),()=>n()("settingPage.transfer")],F),d("change",Nt,L),d("click",J,()=>Vt("followers")),d("click",Kt,()=>Vt("following")),d("click",ze,()=>i(H,!0)),d("click",ja,()=>Rs.set({isOpen:!0,isNeedNeurons:!1})),d("click",Va,()=>i(z,!0)),d("click",Wa,()=>i(O,!0)),v(r,f)},Xe=(r,f)=>{{var x=U=>{var _t=Ur(),Dt=e(_t);w(Dt,{icon:"svg-spinners:ring-resize",width:"32",height:"32"}),ua(2),t(_t),v(U,_t)},h=(U,_t)=>{{var Dt=Nt=>{var Et=Br(),st=e(Et);Ke(st,1,()=>a(p),pa,(ut,J)=>{var Ot=zr(),Ht=e(Ot),Kt=e(Ht);const ne=F(()=>({url:a(J).portrait_url,description:""}));Cs(Kt,{get asset(){return a(ne)}});var ye=s(Kt,2),oe=e(ye);w(oe,{icon:"ph:chat-circle-dots-bold",width:"32",height:"32"}),t(ye);var ce=s(ye,2);{var He=Ve=>{var Ua=jr();v(Ve,Ua)};b(ce,Ve=>{R(a(J).id)&&Ve(He)})}t(Ht);var Ue=s(Ht,2),je=e(Ue),Ze=e(je,!0);t(je);var va=s(je,2),ha=e(va);t(va),t(Ue);var Ea=s(Ue,2),ze=e(Ea),Aa=e(ze);w(Aa,{icon:"ri:edit-line",width:"18",height:"18"}),t(ze);var ta=s(ze,2);let ga;var ya=e(ta);const Fa=F(()=>a(J).visibility==="public"?"ph:eye-bold":"ph:eye-slash-bold");w(ya,{get icon(){return a(Fa)},width:"18",height:"18"}),t(ta),t(Ea),t(Ot),M(Ve=>{o(Ze,a(J).name),o(ha,`${a(J).personaType??""} Type`),ga=yt(ta,1,"action-btn svelte-1r6v9q6",null,ga,Ve),na(ta,"aria-label",a(J).visibility==="public"?"Make Private":"Make Public")},[()=>({active:a(J).visibility==="public"})],F),d("click",Ht,()=>wt(a(J))),d("click",ze,()=>xe(`/edit3?c=${a(J).id}`)),d("click",ta,()=>S(a(J))),v(ut,Ot)});var vt=s(st,2);{var Pt=ut=>{var J=Vr(),Ot=e(J);w(Ot,{icon:"ph:cards-bold",width:"48",height:"48",style:"opacity: 0.3;"}),ua(2),t(J),v(ut,J)};b(vt,ut=>{a(p).length===0&&ut(Pt)})}t(Et),v(Nt,Et)},ie=(Nt,Et)=>{{var st=Pt=>{var ut=Kr(),J=e(ut);Ke(J,1,()=>a(Lt),pa,(Kt,ne)=>{es(Kt,{get content(){return a(ne)},$$events:{click:()=>Ct(a(ne))}})});var Ot=s(J,2);{var Ht=Kt=>{var ne=Wr(),ye=e(ne);w(ye,{icon:"ph:heart-bold",width:"48",height:"48",style:"opacity: 0.3;"});var oe=s(ye,2),ce=e(oe,!0);t(oe),t(ne),M(He=>o(ce,He),[()=>n()("settingPage.noLiked")],F),v(Kt,ne)};b(Ot,Kt=>{a(Lt).length===0&&Kt(Ht)})}t(ut),v(Pt,ut)},vt=(Pt,ut)=>{{var J=Ot=>{var Ht=Gr(),Kt=e(Ht);Ke(Kt,1,()=>a(Tt),pa,(oe,ce)=>{es(oe,{get content(){return a(ce)},$$events:{click:()=>Ct(a(ce))}})});var ne=s(Kt,2);{var ye=oe=>{var ce=Jr(),He=e(ce);w(He,{icon:"ph:users-bold",width:"48",height:"48",style:"opacity: 0.3;"});var Ue=s(He,2),je=e(Ue,!0);t(Ue),t(ce),M(Ze=>o(je,Ze),[()=>n()("settingPage.noFollowing")],F),v(oe,ce)};b(ne,oe=>{a(Tt).length===0&&oe(ye)})}t(Ht),v(Ot,Ht)};b(Pt,Ot=>{a(K)==="following"&&Ot(J)},ut)}};b(Nt,Pt=>{a(K)==="liked"?Pt(st):Pt(vt,!1)},Et)}};b(U,Nt=>{a(K)==="created"?Nt(Dt):Nt(ie,!1)},_t)}};b(r,U=>{a(lt)?U(x):U(h,!1)},f)}};b(Qe,r=>{a(K)==="profile"?r(ma):r(Xe,!1)})}t(Oe),t(Me);var la=s(Me,2);{var Oa=r=>{Ss(r,{get persona(){return a(et)},$$events:{close:()=>i(B,!1)}})};b(la,r=>{a(B)&&a(et)&&r(Oa)})}var Ca=s(la,2);{var Ha=r=>{const f=F(()=>a(l).creator_points||0);Us(r,{get isOpen(){return a(O)},get userPoints(){return a(f)},$$events:{close:()=>i(O,!1),confirm:W}})};b(Ca,r=>{a(l)&&r(Ha)})}var Ra=s(Ca,2);mr(Ra,{get isOpen(){return a(j)},set isOpen(r){i(j,r)},$$events:{close:()=>i(j,!1)},$$legacy:!0});var gt=s(Ra,2);zs(gt,{get isOpen(){return a(E)},set isOpen(r){i(E,r)},$$legacy:!0});var pt=s(gt,2);sr(pt,{get isOpen(){return a(H)},set isOpen(r){i(H,r)},$$events:{close:()=>i(H,!1)},$$legacy:!0});var re=s(pt,2);kr(re,{get userId(){return a(l).id},get isOpen(){return a(at)},set isOpen(r){i(at,r)},get initialTab(){return a(nt)},set initialTab(r){i(nt,r)},$$legacy:!0});var Ye=s(re,2);{var ba=r=>{var f=Qr(),x=e(f),h=e(x),U=e(h,!0);t(h);var _t=s(h,2),Dt=e(_t,!0);t(_t);var ie=s(_t,2),Nt=e(ie,!0);t(ie),t(x),t(f),M((Et,st,vt)=>{o(U,Et),o(Dt,st),o(Nt,vt)},[()=>n()("settingPage.creatorPointInfo.title"),()=>n()("settingPage.creatorPointInfo.desc"),()=>n()("common.confirm",{default:"Confirm"})],F),d("click",ie,()=>i(z,!1)),d("click",x,Pa(function(Et){Na.call(this,q,Et)})),d("click",f,()=>i(z,!1)),d("keypress",f,Et=>Et.key==="Enter"&&i(z,!1)),v(r,f)};b(Ye,r=>{a(z)&&r(ba)})}t(Jt),M((r,f,x,h,U,_t,Dt,ie,Nt)=>{o(be,r),pe=yt(Wt,1,"tab-item svelte-1r6v9q6",null,pe,f),o(ve,x),he=yt(St,1,"tab-item svelte-1r6v9q6",null,he,h),o(ht,U),_=yt(Rt,1,"tab-item svelte-1r6v9q6",null,_,_t),o($t,Dt),Qt=yt(Mt,1,"tab-item svelte-1r6v9q6",null,Qt,ie),o(De,Nt)},[()=>n()("settingPage.title"),()=>({active:a(K)==="profile"}),()=>n()("settingPage.myProfile"),()=>({active:a(K)==="created"}),()=>n()("settingPage.myPersonas"),()=>({active:a(K)==="liked"}),()=>n()("settingPage.liked"),()=>({active:a(K)==="following"}),()=>n()("settingPage.following")],F),d("click",xt,()=>i(j,!0)),d("click",Wt,()=>bt("profile")),d("click",St,()=>bt("created")),d("click",Rt,()=>bt("liked")),d("click",Mt,()=>bt("following")),v(X,Jt),Le(),ft()}export{Ii as component};
