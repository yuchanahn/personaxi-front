import{e as ke,b as X,d as oe}from"../chunks/kz80bbCR.js";import{i as ve}from"../chunks/2r1cYJse.js";import{w as he,aq as N,ar as ge,as as _e,z as we,V as s,W as l,al as r,am as o,ap as p,Q as e,aj as le,O as Y}from"../chunks/BUDlkbfV.js";import{i as ae}from"../chunks/28pso2Hb.js";import{s as be,a as O}from"../chunks/D32zTIdM.js";import{p as Ie}from"../chunks/dMfnY97A.js";import{S as Me,C as Ce,a as Te,m as ce,l as de,s as xe,b as Oe}from"../chunks/-q0Oa4Q3.js";import{l as Be,f as Le}from"../chunks/Caezn3U5.js";import{p as Se}from"../chunks/Do-RpF6d.js";import{s as Pe}from"../chunks/3azsccOw.js";import{c as me}from"../chunks/CmEqjr1-.js";import{c as Ve,o as De}from"../chunks/D0mpzbhj.js";import{s as j}from"../chunks/BbnaKca8.js";import{e as Ne,i as Re}from"../chunks/BOGOvxWJ.js";import{e as K}from"../chunks/CiCNsvIE.js";import{a as Ee,b as Fe}from"../chunks/BJyhluUY.js";import{t as ue,a as He,f as qe}from"../chunks/B2SxtloT.js";import{a as ze}from"../chunks/BqlTOgs2.js";import{p as pe}from"../chunks/Bf5_DoVm.js";import{$ as Ae}from"../chunks/C36u96xB.js";import{I as se}from"../chunks/DaDtKPX8.js";import{N as Ue}from"../chunks/kAk1PkLC.js";import{a as We}from"../chunks/E07TNQLR.js";import{s as fe}from"../chunks/IXAamO68.js";var je=oe('<button><div class="icon-wrapper svelte-u8mh04"><!></div> <div class="info svelte-u8mh04"><div class="top-row svelte-u8mh04"><span class="name svelte-u8mh04"> </span> <!></div> <span class="desc svelte-u8mh04"> </span></div> <div class="cost svelte-u8mh04"><span class="neurons svelte-u8mh04"> <!></span></div></button>'),Qe=oe('<div class="backdrop svelte-u8mh04"><div class="drawer svelte-u8mh04"><div class="drawer-header svelte-u8mh04"><h3 class="svelte-u8mh04"> </h3> <button class="close-btn svelte-u8mh04"><!></button></div> <div class="models-list svelte-u8mh04"></div> <div class="footer svelte-u8mh04"><button class="confirm-btn svelte-u8mh04"> </button></div></div></div>');function Ge(Z,R){he(R,!1);const[b,ee]=be(),d=()=>O(Ae,"$t",b),I=()=>O(Se,"$pricingStore",b),M=l(),Q=l();let S=pe(R,"isOpen",12,!1),c=pe(R,"selectedModel",12,"gemini-flash-lite");const m=Ve();De(()=>{m("confirm",c())});function f(v){c(v),m("select",v)}function B(){m("confirm",c()),S(!1)}function $(){m("close"),S(!1)}N(()=>d(),()=>{s(M,[{id:"gemini-flash-lite",name:d()("models.light"),description:"Fast, efficient, and cost-effective.",icon:"ph:lightning-fill",color:"#fbbf24"},{id:"gemini-flash",name:d()("models.standard"),description:"Balanced performance.",icon:"ph:lightning-bold",color:"#a855f7"},{id:"gemini-pro",name:d()("models.premium"),description:"High reasoning capability.",icon:"ph:brain-fill",color:"#60a5fa"}])}),N(()=>I(),()=>{s(Q,v=>{const u=I().costs.chat_2d||5,h=I().model_multipliers[v]||1;return Math.round(u*h)})}),ge(),ve();var G=ke(),L=_e(G);{var P=v=>{var u=Qe(),h=r(u),_=r(h),w=r(_),C=r(w,!0);o(w);var E=p(w,2),V=r(E);se(V,{icon:"ph:x",width:"20"}),o(E),o(_);var D=p(_,2);Ne(D,5,()=>e(M),Re,(y,n)=>{var T=je();let q;var x=r(T),te=r(x);se(te,{get icon(){return e(n).icon},width:"24"}),o(x);var z=p(x,2),A=r(z),a=r(A),t=r(a,!0);o(a);var g=p(a,2);{var k=W=>{se(W,{icon:"ph:check-circle-fill",class:"check-icon"})};ae(g,W=>{c()===e(n).id&&W(k)})}o(A);var i=p(A,2),U=r(i,!0);o(i),o(z);var re=p(z,2),ie=r(re),ne=r(ie),$e=p(ne);Ue($e,{size:12,color:"currentColor"}),o(ie),o(re),o(T),le((W,ye)=>{q=Ee(T,1,"model-item svelte-u8mh04",null,q,W),Fe(x,`background: ${e(n).color??""}20; color: ${e(n).color??""};`),j(t,e(n).name),j(U,e(n).description),j(ne,`${ye??""} `)},[()=>({selected:c()===e(n).id}),()=>e(Q)(e(n).id)],Y),K("click",T,()=>f(e(n).id)),X(y,T)}),o(D);var F=p(D,2),H=r(F),J=r(H);o(H),o(F),o(h),o(u),le((y,n)=>{j(C,y),j(J,`Start Chat with ${n??""}`)},[()=>d()("models.title"),()=>e(M).find(y=>y.id===c())?.name],Y),K("click",E,$),K("click",H,B),ue(3,h,()=>He,()=>({y:300,duration:300})),ue(3,u,()=>qe,()=>({duration:200})),K("click",u,ze($)),X(v,u)};ae(L,v=>{S()&&v(P)})}X(Z,G),we(),ee()}var Je=oe('<!> <!> <main class="chat-layout svelte-1ya75m5"><div class="settings-button-2d svelte-1ya75m5"><!></div> <div class="chat-container svelte-1ya75m5"><!> <!></div></main>',1);function bt(Z,R){he(R,!1);const[b,ee]=be(),d=()=>O(Ie,"$page",b),I=()=>O(me,"$chatSessions",b),M=()=>O(Se,"$pricingStore",b),Q=()=>O(ce,"$messages",b),S=()=>O(fe,"$settings",b),c=l();let m=l(null),f=l(null),B=l(0),$=l(!1);const G=async()=>{const a=d().url.searchParams.get("c");if(s(m,a),a){ce.set([]),s(f,null),s($,!1);try{const t=await Be(a),g=await Le(t.image_metadatas);t.image_metadatas=g,s(f,t),await de(a??""),Q().length<=1&&s($,!0)}catch(t){console.error("Failed to load chat data:",t)}}};let L=l(!1),P=l(!1);const v=async(a,t)=>{if(e(L)||e(P))return;const g=d().url.searchParams.get("c");Pe.update(i=>(i&&i.credits>=e(B)&&(i.credits-=e(B)),i));let k=i=>{t?.(i),de(g??"")};s(L,!0),s(P,!0),await xe(g??"",a,"2d",()=>{s(P,!1),s(L,!1)},void 0,k)};let u=l(!1),h=l(S().showImage??!0),_=l(S().autoScroll??!0),w=l(S().showBackground??!1),C=l(S().showVariableStatus??!1);const E=async a=>{const t=a.detail,g=new URL(window.location.href);g.searchParams.set("llmType",t),window.history.replaceState({},"",g);const k=I().find(i=>i.id===e(m));if(k&&(k.llmType=t,me.update(i=>i.map(U=>U.id===e(m)?{...U,llmType:t}:U))),s(c,t),e(f)?.id)try{await We.post("/api/chat/char/sessions/edit",{cssid:e(f).id,llmType:t}),console.log("Saved LLM preference:",t)}catch(i){console.error("Failed to save LLM preference:",i)}s($,!1)};let V=l(!1);N(()=>d(),()=>{s(c,d().url.searchParams.get("llmType")||"Error")}),N(()=>(e(c),I(),e(m),M()),()=>{if(e(c)){const t=I().find(i=>i.id===e(m))?.llmType||e(c)||"gemini-flash-lite",g=M().costs.chat_2d||10,k=M().model_multipliers[t]||1;s(B,Math.round(g*k))}}),N(()=>(d(),e(m)),()=>{d().url.searchParams.get("c")!==e(m)&&G()}),N(()=>(e(h),e(_),e(w),e(C)),()=>{fe.update(a=>({...a,showImage:e(h),autoScroll:e(_),showBackground:e(w),showVariableStatus:e(C)}))}),ge(),ve();var D=Je(),F=_e(D);{var H=a=>{Oe(a,{get persona(){return e(f)},get isOpen(){return e(u)},get llmType(){return e(c)},mode:"2d",get showImage(){return e(h)},set showImage(t){s(h,t)},get autoScroll(){return e(_)},set autoScroll(t){s(_,t)},get showBackground(){return e(w)},set showBackground(t){s(w,t)},get showVariableStatus(){return e(C)},set showVariableStatus(t){s(C,t)},$$events:{close:()=>s(u,!1)},$$legacy:!0})};ae(F,a=>{e(u)&&e(f)&&a(H)})}var J=p(F,2);Ge(J,{get isOpen(){return e($)},get selectedModel(){return e(c)},$$events:{close:()=>s($,!1),confirm:E}});var y=p(J,2),n=r(y),T=r(n);Me(T,{onClick:()=>s(u,!0)}),o(n);var q=p(n,2),x=r(q);Ce(x,{get isLoading(){return e(L)},get persona(){return e(f)},get showImage(){return e(h)},get autoScroll(){return e(_)},SendMessage:v,get showBackground(){return e(w)},get showVariableStatus(){return e(C)},get showRatioOptions(){return e(V)},set showRatioOptions(a){s(V,a)},$$legacy:!0});var te=p(x,2);const z=Y(()=>e(f)?.name),A=Y(()=>!!e(f)?.static_portrait_url);Te(te,{onSend:v,get isDisabled(){return e(P)},get placeholderName(){return e(z)},mode:"2d",get neededNeurons(){return e(B)},get hasStaticImage(){return e(A)},onImageClick:()=>{s(V,!e(V))}}),o(q),o(y),X(Z,D),we(),ee()}export{bt as component};
