import"../chunks/NZTpNUN0.js";import"../chunks/Vvm9udaT.js";import{o as I,a as D}from"../chunks/BB32ouRY.js";import{X as W,W as q,l as E,_ as L,a2 as o,aw as m,x as R,w as h,L as V,a0 as X,a3 as i}from"../chunks/DJxVeldX.js";import{s as j}from"../chunks/C9woGF-z.js";import{b as z,a as A}from"../chunks/fOQuHGXh.js";import{b as F}from"../chunks/Bw-tA-uZ.js";import{b as G}from"../chunks/B1Ur4i1a.js";import{i as H}from"../chunks/Degfot_7.js";import{a as b,s as J}from"../chunks/ZTUH0_7J.js";import{B as K,a as N,s as O,c as Q}from"../chunks/3VCbvMKO.js";import{t as T}from"../chunks/Da5C1udi.js";import{l as U}from"../chunks/BGAOhipI.js";import{p as Y}from"../chunks/pmDB9vb6.js";import{$ as Z}from"../chunks/Bit4kGOU.js";var ee=z('<div id="broadcast-layout" class="svelte-1wv0lui"><canvas class="vrm-canvas svelte-1wv0lui"></canvas> <div class="sidebar svelte-1wv0lui"><div class="persona-header svelte-1wv0lui"><h2> </h2></div> <!> <!></div></div>');function fe(P,d){W(d,!1);const[p,$]=J(),a=()=>b(Z,"$t",p),M=()=>b(Y,"$page",p);let s=null,n=V(),l=null,g=null;s={name:"test"};const t=q([]);t.set([{user:a()("livePage.viewer1"),msg:a()("livePage.viewer1Message")},{user:a()("livePage.viewer2"),msg:a()("livePage.viewer2Message")},{user:a()("livePage.viewer3"),msg:a()("livePage.viewer3Message")}]),I(async()=>{const e=M().url.searchParams.get("c");if(e!==g&&(g=e,e&&(s=await U(e))),!!s){l=Q(s.id,r=>{let S=r;t.update(k=>[...k,{user:a()("livePage.me"),msg:S.msg}])});try{s&&T(h(n),s).then(r=>void 0).finally()}catch(r){console.error("Error loading VRM:",r)}}}),D(()=>{l&&(console.log(a()("livePage.websocketDisconnected")),l.close())});function y(e){O(e)}H();var v=ee(),u=o(v);G(u,e=>X(n,e),()=>h(n));var f=m(u,2),c=o(f),w=o(c),B=o(w,!0);i(w),i(c);var _=m(c,2);K(_,{get messages(){return t}});var x=m(_,2);N(x,{onSend:y}),i(f),i(v),E(e=>j(B,e),[()=>a()("livePage.broadcastContent")],R),A(P,v),F(d,"broadcastMessages",t);var C=L({broadcastMessages:t});return $(),C}export{fe as component};
