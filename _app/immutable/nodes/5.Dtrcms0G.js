import{d as h,b as m}from"../chunks/kz80bbCR.js";import{i as H}from"../chunks/2r1cYJse.js";import{o as J}from"../chunks/D0mpzbhj.js";import{w as K,z as X,V as r,W as u,Q as s,al as t,ap as f,am as o,an as z,aj as k}from"../chunks/BUDlkbfV.js";import{s as U}from"../chunks/BbnaKca8.js";import{i as C}from"../chunks/28pso2Hb.js";import{r as A}from"../chunks/BJyhluUY.js";import{e as Z}from"../chunks/CiCNsvIE.js";import{b as D}from"../chunks/njKOc8Q7.js";import{p as $}from"../chunks/BqlTOgs2.js";import{s as E}from"../chunks/C-VEydUt.js";import{g as M}from"../chunks/DqiWXVxP.js";import{t as O}from"../chunks/sXlFIKQv.js";import{I as W}from"../chunks/DaDtKPX8.js";var ss=h('<div class="error-state svelte-bhfiqp"><!> <p> </p> <p class="sub-text svelte-bhfiqp">Redirecting to login...</p></div>'),es=h('<div class="error-message svelte-bhfiqp"> </div>'),rs=h('<form class="form svelte-bhfiqp"><!> <div class="form-group svelte-bhfiqp"><label for="new-password" class="svelte-bhfiqp">New Password</label> <input id="new-password" type="password" required placeholder="Enter new password" minlength="6" class="svelte-bhfiqp"/></div> <div class="form-group svelte-bhfiqp"><label for="confirm-password" class="svelte-bhfiqp">Confirm Password</label> <input id="confirm-password" type="password" required placeholder="Confirm new password" minlength="6" class="svelte-bhfiqp"/></div> <button class="submit-button svelte-bhfiqp" type="submit"> </button></form>'),as=h('<div class="loading svelte-bhfiqp"><!> <p>Verifying link...</p></div>'),ts=h('<div class="page-wrapper svelte-bhfiqp"><div class="container svelte-bhfiqp"><h1 class="title svelte-bhfiqp">Update Password</h1> <!></div></div>');function gs(j,F){K(F,!1);let c=u(""),_=u(""),b=u(!1),a=u(""),w=u(!1);J(()=>{(async()=>{const{data:{session:i},error:d}=await E.auth.getSession();d||!i?(r(a,"Invalid or expired password reset link."),O.error(s(a)),setTimeout(()=>M("/login"),3e3)):r(w,!0)})();const{data:{subscription:n}}=E.auth.onAuthStateChange((i,d)=>{i==="PASSWORD_RECOVERY"&&r(w,!0)});return()=>n.unsubscribe()});const L=async()=>{if(s(c)!==s(_)){r(a,"Passwords do not match.");return}if(s(c).length<6){r(a,"Password must be at least 6 characters.");return}r(b,!0),r(a,"");try{const{error:e}=await E.auth.updateUser({password:s(c)});if(e)throw e;O.success("Password updated successfully!"),M("/hub")}catch(e){e instanceof Error?r(a,e.message):r(a,"Failed to update password.")}finally{r(b,!1)}};H();var q=ts(),R=t(q),N=f(t(R),2);{var Q=e=>{var n=ss(),i=t(n);W(i,{icon:"mdi:alert-circle",width:"48",height:"48",color:"var(--color-error)"});var d=f(i,2),l=t(d,!0);o(d),z(2),o(n),k(()=>U(l,s(a))),m(e,n)},T=(e,n)=>{{var i=l=>{var p=rs(),g=t(p);{var Y=v=>{var S=es(),G=t(S,!0);o(S),k(()=>U(G,s(a))),m(v,S)};C(g,v=>{s(a)&&v(Y)})}var P=f(g,2),V=f(t(P),2);A(V),o(P);var y=f(P,2),I=f(t(y),2);A(I),o(y);var x=f(y,2),B=t(x,!0);o(x),o(p),k(()=>{x.disabled=s(b),U(B,s(b)?"Updating...":"Update Password")}),D(V,()=>s(c),v=>r(c,v)),D(I,()=>s(_),v=>r(_,v)),Z("submit",p,$(L)),m(l,p)},d=l=>{var p=as(),g=t(p);W(g,{icon:"svg-spinners:ring-resize",width:"32",height:"32"}),z(2),o(p),m(l,p)};C(e,l=>{s(w)?l(i):l(d,!1)},n)}};C(N,e=>{!s(w)&&s(a)?e(Q):e(T,!1)})}o(R),o(q),m(j,q),X()}export{gs as component};
