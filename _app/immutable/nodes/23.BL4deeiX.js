import{d as w,b as y}from"../chunks/kz80bbCR.js";import{i as A}from"../chunks/2r1cYJse.js";import{o as D}from"../chunks/D0mpzbhj.js";import{w as E,z as H,V as P,W as $,Q as b,al as c,am as m,ap as i,as as k,aj as R,O as T}from"../chunks/BUDlkbfV.js";import{s as p}from"../chunks/BbnaKca8.js";import{i as U}from"../chunks/28pso2Hb.js";import{e as J}from"../chunks/CiCNsvIE.js";import{s as K,a as N}from"../chunks/D32zTIdM.js";import{g as _}from"../chunks/DqiWXVxP.js";import{I as M}from"../chunks/DaDtKPX8.js";import{$ as X}from"../chunks/C36u96xB.js";var Y=w('<div class="spinner svelte-1b6404m"></div> <h2 class="svelte-1b6404m"> </h2> <p class="svelte-1b6404m"> </p>',1),Z=w('<!> <h2 class="svelte-1b6404m"> </h2> <p class="svelte-1b6404m"> </p>',1),ee=w('<!> <h2 class="svelte-1b6404m"> </h2> <p class="svelte-1b6404m"> </p> <button class="svelte-1b6404m"> </button>',1),te=w('<div class="payment-complete-container svelte-1b6404m"><div class="content svelte-1b6404m"><!></div></div>');function ve(j,q){E(q,!1);const[z,B]=K(),u=()=>N(X,"$t",z);let g=$("processing"),S=$(""),v="";D(async()=>{const t=new URLSearchParams(window.location.search),r=t.get("code"),s=t.get("message"),d=s?decodeURIComponent(s):"";v=localStorage.getItem("payment_return_url");const e=()=>{const o=localStorage.getItem("payment_start_history_len"),n=()=>{v?_(v,{replaceState:!0}):_("/",{replaceState:!0})};if(o){const a=parseInt(o,10),l=window.history.length-a;localStorage.removeItem("payment_start_history_len"),l>0?(window.history.go(-l),setTimeout(()=>{},500)):n()}else n()};if(r){P(g,"failed"),P(S,d||"Payment was cancelled or failed."),console.error("Payment Failed:",r,b(S)),localStorage.removeItem("payment_return_url"),setTimeout(()=>{e()},3e3);return}if(!v){_("/",{replaceState:!0});return}setTimeout(()=>{P(g,"success"),localStorage.removeItem("payment_return_url"),setTimeout(()=>{e()},3e3)},1500)});function C(){const t=localStorage.getItem("payment_start_history_len");if(!v){_("/",{replaceState:!0});return}const r=()=>{_(v,{replaceState:!0})};if(t){const s=parseInt(t,10),e=window.history.length-s;localStorage.removeItem("payment_start_history_len"),e>0?(window.history.go(-e),setTimeout(()=>{},500)):r()}else r()}A();var I=te(),F=c(I),G=c(F);{var O=t=>{var r=Y(),s=i(k(r),2),d=c(s,!0);m(s);var e=i(s,2),o=c(e,!0);m(e),R((n,a)=>{p(d,n),p(o,a)},[()=>u()("payment.processing",{default:"Processing Payment..."}),()=>u()("payment.wait_moment",{default:"Please wait a moment."})],T),y(t,r)},Q=(t,r)=>{{var s=e=>{var o=Z(),n=k(o);M(n,{icon:"ph:check-circle-bold",class:"success-icon",width:"64"});var a=i(n,2),h=c(a,!0);m(a);var l=i(a,2),x=c(l,!0);m(l),R((f,L)=>{p(h,f),p(x,L)},[()=>u()("payment.success",{default:"Payment Successful!"}),()=>u()("payment.redirecting",{default:"Redirecting to shop..."})],T),y(e,o)},d=e=>{var o=ee(),n=k(o);M(n,{icon:"ph:x-circle-bold",class:"error-icon",width:"64"});var a=i(n,2),h=c(a,!0);m(a);var l=i(a,2),x=c(l,!0);m(l);var f=i(l,2),L=c(f,!0);m(f),R((V,W)=>{p(h,V),p(x,b(S)),p(L,W)},[()=>u()("payment.failed",{default:"Payment Failed"}),()=>u()("common.back",{default:"Go Back"})],T),J("click",f,()=>C()),y(e,o)};U(t,e=>{b(g)==="success"?e(s):e(d,!1)},r)}};U(G,t=>{b(g)==="processing"?t(O):t(Q,!1)})}m(F),m(I),y(j,I),H(),B()}export{ve as component};
