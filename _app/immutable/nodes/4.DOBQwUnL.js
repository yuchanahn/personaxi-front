import"../chunks/NZTpNUN0.js";import"../chunks/Vvm9udaT.js";import{c as Pt,o as Tt,a as kt}from"../chunks/BB32ouRY.js";import{X as ht,L as x,a2 as a,a3 as r,aw as n,w as t,l as y,x as E,a0 as u,_ as _t,au as Ct,av as Et,Z as ft,W as St,aA as mt}from"../chunks/DJxVeldX.js";import{s as l,e as Z}from"../chunks/C9woGF-z.js";import{i as L}from"../chunks/292SS5JT.js";import{b as q,a as I,t as gt}from"../chunks/fOQuHGXh.js";import{b as Ut}from"../chunks/Bw-tA-uZ.js";import{b as At}from"../chunks/B1Ur4i1a.js";import{i as bt}from"../chunks/Degfot_7.js";import{a as vt,s as wt}from"../chunks/ZTUH0_7J.js";import{p as Dt}from"../chunks/pmDB9vb6.js";import{l as Ht}from"../chunks/BGAOhipI.js";import{p as Lt,f as qt}from"../chunks/htZiybrN.js";import{B as Wt,a as jt,c as Ft,s as Kt}from"../chunks/3VCbvMKO.js";import"../chunks/Dq_rjOCf.js";import"../chunks/BXQQiVcS.js";import"../chunks/knpjl46v.js";import{$ as $t}from"../chunks/Bit4kGOU.js";import"../chunks/gt9WcTCj.js";import{r as Ot,s as lt}from"../chunks/CVCkp_ml.js";import{t as Rt,f as Vt}from"../chunks/CZB4GwcB.js";import{b as Xt}from"../chunks/BgFAjVCA.js";import{a as Zt}from"../chunks/BqlTOgs2.js";import{p as ct}from"../chunks/Zfh5ko2t.js";import{q as Gt}from"../chunks/Ccw7PXcW.js";var Jt=q('<p class="error-message svelte-1pfiozz"> </p>'),Nt=q('<div class="modal-backdrop svelte-1pfiozz" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-content svelte-1pfiozz"><h2 class="svelte-1pfiozz"> </h2> <div class="bid-info svelte-1pfiozz"><p class="svelte-1pfiozz"><strong> </strong> </p> <p class="svelte-1pfiozz"><strong> </strong> </p></div> <div class="input-group svelte-1pfiozz"><label for="bid-amount" class="svelte-1pfiozz"> </label> <input id="bid-amount" type="number" class="svelte-1pfiozz"/></div> <!> <div class="button-group svelte-1pfiozz"><button class="submit-button svelte-1pfiozz"><!></button> <button class="cancel-button svelte-1pfiozz"> </button></div></div></div>');function Qt(et,P){ht(P,!1);const[G,at]=wt(),p=()=>vt($t,"$t",G);let v=ct(P,"personaId",8),w=ct(P,"currentHighestBid",8,0),h=ct(P,"minBidIncrement",8,10);const $=Pt();let d=x(w()+h()),z=x(""),_=x(!1);function W(){$("close")}async function j(){if(t(d)<=w()){u(z,p()("bidModal.bidTooLow",{values:{currentHighestBid:w()}}));return}if(t(d)%h()!==0){u(z,p()("bidModal.bidIncrementError",{values:{minBidIncrement:h()}}));return}u(_,!0),u(z,"");try{await Lt(v(),t(d)),$("close")}catch(i){u(z,i.message||p()("bidModal.bidError"))}finally{u(_,!1)}}function b(i){i.key==="Escape"&&W()}bt();var T=Nt(),S=a(T),U=a(S),F=a(U,!0);r(U);var A=n(U,2),D=a(A),k=a(D),J=a(k);r(k);var rt=n(k);r(D);var K=n(D,2),O=a(K),H=a(O);r(O);var st=n(O);r(K),r(A);var R=n(A,2),V=a(R),N=a(V);r(V);var B=n(V,2);Ot(B),r(R);var Q=n(R,2);{var it=i=>{var c=Jt(),f=a(c,!0);r(c),y(()=>l(f,t(z))),I(i,c)};L(Q,i=>{t(z)&&i(it)})}var Y=n(Q,2),C=a(Y),e=a(C);{var s=i=>{var c=gt();y(f=>l(c,f),[()=>p()("bidModal.biddingInProgress")],E),I(i,c)},o=i=>{var c=gt();y(f=>l(c,f),[()=>p()("bidModal.placeBid")],E),I(i,c)};L(e,i=>{t(_)?i(s):i(o,!1)})}r(C);var m=n(C,2),M=a(m,!0);r(m),r(Y),r(S),r(T),y((i,c,f,g,X,ot,tt,nt)=>{l(F,i),l(J,`${c??""}:`),l(rt,` ${w()??""} ${f??""}`),l(H,`${g??""}:`),l(st,` ${h()??""} ${X??""}`),l(N,`${ot??""}:`),lt(B,"min",w()+h()),lt(B,"step",h()),lt(B,"placeholder",tt),B.disabled=t(_),C.disabled=t(_),m.disabled=t(_),l(M,nt)},[()=>p()("bidModal.title"),()=>p()("bidModal.currentHighestBid"),()=>p()("bidModal.credits"),()=>p()("bidModal.minBidIncrement"),()=>p()("bidModal.credits"),()=>p()("bidModal.bidCredits"),()=>`${w()+h()} ${p()("bidModal.minBidPlaceholder")}`,()=>p()("bidModal.cancel")],E),Xt(B,()=>t(d),i=>u(d,i)),Z("click",C,j),Z("click",m,W),Rt(3,S,()=>Vt,()=>({y:-50,duration:300,easing:Gt})),Z("click",T,Zt(W)),Z("keydown",T,b),I(et,T),_t(),at()}var Yt=q('<h2 class="persona-name svelte-1t5hwdi"> </h2> <p class="user-credits svelte-1t5hwdi"> <strong></strong></p>',1),te=q('<div class="status-box svelte-1t5hwdi"><p class="svelte-1t5hwdi"><strong class="svelte-1t5hwdi"> </strong> <span class="highlight-bid svelte-1t5hwdi"> </span> </p> <p class="svelte-1t5hwdi"><strong class="svelte-1t5hwdi"> </strong> <span class="highlight-time svelte-1t5hwdi"> </span></p> <p class="svelte-1t5hwdi"><strong class="svelte-1t5hwdi"> </strong> <span class="highlight-winner svelte-1t5hwdi"> </span></p></div>'),ee=q('<p class="error-message svelte-1t5hwdi"> </p>'),ae=q('<div class="auction-live-layout svelte-1t5hwdi"><canvas class="vrm-canvas svelte-1t5hwdi"></canvas> <div class="info-sidebar svelte-1t5hwdi"><div class="auction-info svelte-1t5hwdi"><!> <!> <button class="bid-button svelte-1t5hwdi"> </button> <!></div> <div class="chat-area svelte-1t5hwdi"><!> <!></div></div></div> <!>',1);function Te(et,P){ht(P,!1);const[G,at]=wt(),p=()=>vt(Dt,"$page",G),v=()=>vt($t,"$t",G);let w=x(!1),h=x(""),$=x(null),d=x(null),z=x();const _=St([]);Tt(async()=>{const e=p().url.searchParams.get("c");if(e){u($,await Ht(e));try{u(d,await qt(e))}catch(s){console.error("fetchAuctionStatus :",s)}Ft(t($)?.id||"fuck",s=>{if(s.type==="bid"){let o=s.bid;if(!t(d))return;mt(d,t(d).highestBid=o.amount),mt(d,t(d).winner=o.userId)}else s.type==="chat"&&_.update(o=>[...o,{user:v()("auctionPage.bidder"),msg:s.msg}])});try{t($)}catch(s){console.error("Error loading VRM:",s)}}});function W(e){Kt(e)}let j=x(v()("auctionPage.calculatingTime")),b=x();function T(e){if(e<=0)return v()("auctionPage.auctionEnded");const s=Math.floor(e/1e3),o=Math.floor(s/60),m=Math.floor(o/60),M=Math.floor(m/24),i=s%60,c=o%60,f=m%24;let g=[];return M>0&&g.push(`${M}${v()("auctionPage.dayUnit")}`),f>0&&g.push(`${f}${v()("auctionPage.hourUnit")}`),c>0&&g.push(`${c}${v()("auctionPage.minuteUnit")}`),(i>0||g.length===0)&&g.push(`${i}${v()("auctionPage.secondUnit")}`),g.length===0&&e>0?`0${v()("auctionPage.secondUnit")}`:g.join(" ")}function S(){if(!t(d)||!t(d).endAt){u(j,v()("auctionPage.noTimeInfo")),t(b)&&clearInterval(t(b));return}const e=new Date(t(d).endAt).getTime(),s=Date.now(),o=e-s;u(j,T(o)),o<=0&&clearInterval(t(b))}kt(()=>{t(b)&&clearInterval(t(b))}),Ct(()=>(t(d),t(b)),()=>{t(d)&&(t(b)&&clearInterval(t(b)),S(),u(b,setInterval(S,1e3)))}),Et(),bt();var U=ae(),F=ft(U),A=a(F);At(A,e=>u(z,e),()=>t(z));var D=n(A,2),k=a(D),J=a(k);{var rt=e=>{var s=Yt(),o=ft(s),m=a(o,!0);r(o);var M=n(o,2),i=a(M),c=n(i);c.textContent="255",r(M),y(f=>{l(m,t($).name),l(i,`${f??""}: `)},[()=>v()("auctionPage.myCredits")],E),I(e,s)};L(J,e=>{t($)&&e(rt)})}var K=n(J,2);{var O=e=>{var s=te(),o=a(s),m=a(o),M=a(m);r(m);var i=n(m,2),c=a(i,!0);r(i);var f=n(i);r(o);var g=n(o,2),X=a(g),ot=a(X);r(X);var tt=n(X,2),nt=a(tt,!0);r(tt),r(g);var ut=n(g,2),dt=a(ut),xt=a(dt);r(dt);var pt=n(dt,2),zt=a(pt,!0);r(pt),r(ut),r(s),y((Bt,Mt,yt,It)=>{l(M,`${Bt??""}:`),l(c,t(d).highestBid),l(f,` ${Mt??""}`),l(ot,`${yt??""}:`),l(nt,t(j)),l(xt,`${It??""}:`),l(zt,t(d).winner)},[()=>v()("auctionPage.highestBid"),()=>v()("auctionPage.creditsUnit"),()=>v()("auctionPage.remainingTime"),()=>v()("auctionPage.currentLeader")],E),I(e,s)};L(K,e=>{t(d)&&e(O)})}var H=n(K,2),st=a(H,!0);r(H);var R=n(H,2);{var V=e=>{var s=ee(),o=a(s,!0);r(s),y(()=>l(o,t(h))),I(e,s)};L(R,e=>{t(h)&&e(V)})}r(k);var N=n(k,2),B=a(N);Wt(B,{get messages(){return _}});var Q=n(B,2);jt(Q,{onSend:W}),r(N),r(D),r(F);var it=n(F,2);{var Y=e=>{const s=E(()=>t(d)?.highestBid||0);Qt(e,{get personaId(){return t($).id},get currentHighestBid(){return t(s)},minBidIncrement:10,$$events:{close:()=>u(w,!1),error:o=>u(h,o.detail)}})};L(it,e=>{t(w)&&t($)&&e(Y)})}y(e=>l(st,e),[()=>v()("auctionPage.placeBidButton")],E),Z("click",H,()=>u(w,!0)),I(et,U),Ut(P,"broadcastMessages",_);var C=_t({broadcastMessages:_});return at(),C}export{Te as component};
