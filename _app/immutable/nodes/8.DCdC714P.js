import{d as q,b as L}from"../chunks/kz80bbCR.js";import{i as Ae}from"../chunks/2r1cYJse.js";import{w as De,aq as U,ar as Me,z as Ne,V as le,W as ie,Q as r,al as o,am as t,aj as ne,as as Qe,ap as c,O as Re}from"../chunks/BUDlkbfV.js";import{s as u}from"../chunks/BbnaKca8.js";import{i as W}from"../chunks/28pso2Hb.js";import{e as Ve}from"../chunks/BOGOvxWJ.js";import{s as ce,a as O}from"../chunks/BJyhluUY.js";import{e as j}from"../chunks/CiCNsvIE.js";import{s as We,a as n}from"../chunks/D32zTIdM.js";import{p as Ge}from"../chunks/dMfnY97A.js";import{w as p}from"../chunks/e6l8DgL1.js";import{C as He}from"../chunks/CBbSIjb6.js";import{$ as Je}from"../chunks/C36u96xB.js";import{a as Ke}from"../chunks/E07TNQLR.js";import{g as Te}from"../chunks/DqiWXVxP.js";import{g as ue,c as ve,u as Xe,f as Ye}from"../chunks/CIhK29i5.js";import{s as Ze}from"../chunks/3azsccOw.js";import{t as fe}from"../chunks/sXlFIKQv.js";var et=q('<div class="center-message svelte-niuo3y">Loading creator profile...</div>'),tt=q('<div class="center-message error svelte-niuo3y"> </div>'),rt=q('<div class="creator-header svelte-niuo3y"><div class="creator-info svelte-niuo3y"><img class="creator-portrait svelte-niuo3y"/> <div class="creator-details svelte-niuo3y"><h1 class="creator-name svelte-niuo3y"> </h1> <div class="stats-row svelte-niuo3y"><p class="creator-persona-count"> </p> <span class="divider svelte-niuo3y">â€¢</span> <p class="creator-follower-count"> </p></div></div></div> <button> </button></div> <div class="hub-container svelte-niuo3y"><div class="sort-controls svelte-niuo3y"><button> </button> <button> </button> <button> </button></div> <div class="content-grid svelte-niuo3y"></div></div>',1),ot=q('<div class="page-wrapper svelte-niuo3y"><!></div>');function kt(pe,de){De(de,!1);const[l,me]=We(),G=()=>n(Ge,"$page",l),d=()=>n(Ze,"$st_user",l),v=()=>n(Je,"$t",l),B=()=>n(_,"$isFollowing",l),i=()=>n(K,"$profile",l),m=()=>n(x,"$sortOrder",l),_e=()=>n(E,"$isLoading",l),H=()=>n(I,"$error",l),ge=()=>n(b,"$followerCount",l),J=ie();let K=p(null),E=p(!0),I=p(null),_=p(!1),b=p(0),x=p("likes"),s=ie(null);async function he(){if(!d()){fe.warning(v()("common.loginRequired"));return}if(r(s))try{B()?await Xe(r(s))&&(_.set(!1),b.update(a=>Math.max(0,a-1))):await Ye(r(s))&&(_.set(!0),b.update(a=>a+1))}catch(e){console.error("Follow toggle failed",e),fe.error("Failed to update follow status")}}function we(e){Te(`/profile?c=${e.id}`)}U(()=>G(),()=>{le(s,G().url.searchParams.get("c"))}),U(()=>(r(s),ue),()=>{r(s)&&(E.set(!0),I.set(null),Ke.get2(`/api/creator/info?id=${r(s)}`).then(async e=>{if(!e.ok){const a=await e.json();throw new Error(a.error||"Failed to load creator profile.")}return e.json()}).then(e=>(K.set(e),ue(r(s)))).then(e=>{b.set(e.length)}).catch(e=>{I.set(e.message)}).finally(()=>{E.set(!1)}))}),U(()=>(r(s),d(),ve),()=>{r(s)&&d()?(console.log("Checking follow status for:",r(s),"User:",d()),ve(r(s)).then(e=>{console.log("Follow status result:",e),_.set(e)})):(console.log("Skipping follow check. CreatorId:",r(s),"User:",d()),_.set(!1))}),U(()=>(i(),m()),()=>{le(J,(()=>{if(!i())return[];const e=[...i().personas||[]],a=m();return e.sort((g,h)=>a==="likes"?h.likes_count-g.likes_count:a==="chats"?h.chat_count-g.chat_count:a==="name"?g.name.localeCompare(h.name):0)})())}),Me(),Ae();var S=ot(),$e=o(S);{var ye=e=>{var a=et();L(e,a)},ke=(e,a)=>{{var g=f=>{var w=tt(),z=o(w);t(w),ne(()=>u(z,`Error: ${H()??""}`)),L(f,w)},h=(f,w)=>{{var z=A=>{var T=rt(),D=Qe(T),M=o(D),N=o(M),X=c(N,2),Q=o(X),be=o(Q,!0);t(Q);var Y=c(Q,2),R=o(Y),xe=o(R);t(R);var Z=c(R,4),Ce=o(Z);t(Z),t(Y),t(X),t(M);var C=c(M,2);let ee;var Fe=o(C,!0);t(C),t(D);var te=c(D,2),V=o(te),$=o(V);let re;var Pe=o($,!0);t($);var y=c($,2);let oe;var Le=o(y,!0);t(y);var F=c(y,2);let se;var Ue=o(F,!0);t(F),t(V);var ae=c(V,2);Ve(ae,5,()=>r(J),k=>k.id,(k,P)=>{He(k,{get content(){return r(P)},$$events:{click:()=>we(r(P))}})}),t(ae),t(te),ne((k,P,Oe,je,qe,Be,Ee,Ie,Se,ze)=>{ce(N,"src",k),ce(N,"alt",i().creator.name),u(be,i().creator.name),u(xe,`${(i().personas?.length||0)??""}
                            ${P??""}`),u(Ce,`${ge()??""} Followers`),ee=O(C,1,"follow-button svelte-niuo3y",null,ee,Oe),u(Fe,je),re=O($,1,"svelte-niuo3y",null,re,qe),u(Pe,Be),oe=O(y,1,"svelte-niuo3y",null,oe,Ee),u(Le,Ie),se=O(F,1,"svelte-niuo3y",null,se,Se),u(Ue,ze)},[()=>i().creator.portrait_url||"https://placehold.co/128x128/1a1a1a/ffffff?text="+i().creator.name.charAt(0),()=>v()("creatorPage.personas"),()=>({following:B()}),()=>B()?"Unfollow":v()("creatorPage.follow"),()=>({active:m()==="likes"}),()=>v()("creatorPage.sortByLikes"),()=>({active:m()==="chats"}),()=>v()("creatorPage.sortByChats"),()=>({active:m()==="name"}),()=>v()("creatorPage.sortByName")],Re),j("click",C,he),j("click",$,()=>x.set("likes")),j("click",y,()=>x.set("chats")),j("click",F,()=>x.set("name")),L(A,T)};W(f,A=>{i()&&A(z)},w)}};W(e,f=>{H()?f(g):f(h,!1)},a)}};W($e,e=>{_e()?e(ye):e(ke,!1)})}t(S),L(pe,S),Ne(),me()}export{kt as component};
